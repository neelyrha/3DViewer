<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>3D Viewer: gif.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">3D Viewer
   </div>
   <div id="projectbrief">view 3D wire-frame models</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">gif.h File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;stdint.h&gt;</code><br />
<code>#include &lt;stdbool.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
</div>
<p><a href="gif_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_gif_palette.html">GifPalette</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_gif_bit_status.html">GifBitStatus</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_gif_lzw_node.html">GifLzwNode</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_gif_writer.html">GifWriter</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a94974606594583031e18618c12dfd1eb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gif_8h.html#a94974606594583031e18618c12dfd1eb">GIF_TEMP_MALLOC</a>&#160;&#160;&#160;malloc</td></tr>
<tr class="separator:a94974606594583031e18618c12dfd1eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23e287fdaa48ccff1c3ff9500f358c23"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gif_8h.html#a23e287fdaa48ccff1c3ff9500f358c23">GIF_TEMP_FREE</a>&#160;&#160;&#160;free</td></tr>
<tr class="separator:a23e287fdaa48ccff1c3ff9500f358c23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05d55b62cb33c1317606fc83b79fbd2d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gif_8h.html#a05d55b62cb33c1317606fc83b79fbd2d">GIF_MALLOC</a>&#160;&#160;&#160;malloc</td></tr>
<tr class="separator:a05d55b62cb33c1317606fc83b79fbd2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bc34de883cfe8bc534246ed759419f2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gif_8h.html#a3bc34de883cfe8bc534246ed759419f2">GIF_FREE</a>&#160;&#160;&#160;free</td></tr>
<tr class="separator:a3bc34de883cfe8bc534246ed759419f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:abec89660e26d5d306a68352215b9a0be"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gif_8h.html#abec89660e26d5d306a68352215b9a0be">GifIMax</a> (int l, int r)</td></tr>
<tr class="separator:abec89660e26d5d306a68352215b9a0be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9dd9d911741bf4964afc6365ee09314"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gif_8h.html#ab9dd9d911741bf4964afc6365ee09314">GifIMin</a> (int l, int r)</td></tr>
<tr class="separator:ab9dd9d911741bf4964afc6365ee09314"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f47fdcc507db606e3817489e15389bf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gif_8h.html#a3f47fdcc507db606e3817489e15389bf">GifIAbs</a> (int i)</td></tr>
<tr class="separator:a3f47fdcc507db606e3817489e15389bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17526c4fd7bdc86c779c6253279abee5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gif_8h.html#a17526c4fd7bdc86c779c6253279abee5">GifGetClosestPaletteColor</a> (<a class="el" href="struct_gif_palette.html">GifPalette</a> *pPal, int r, int g, int b, int *bestInd, int *bestDiff, int treeRoot)</td></tr>
<tr class="separator:a17526c4fd7bdc86c779c6253279abee5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6df6365a4dbdd83db88521f7159af7f7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gif_8h.html#a6df6365a4dbdd83db88521f7159af7f7">GifSwapPixels</a> (uint8_t *image, int pixA, int pixB)</td></tr>
<tr class="separator:a6df6365a4dbdd83db88521f7159af7f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d40946fe75133f3be72b4e4d096b776"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gif_8h.html#a5d40946fe75133f3be72b4e4d096b776">GifPartition</a> (uint8_t *image, const int left, const int right, const int elt, int pivotIndex)</td></tr>
<tr class="separator:a5d40946fe75133f3be72b4e4d096b776"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3789c1923f40cb85ccccca4fcdae41c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gif_8h.html#aa3789c1923f40cb85ccccca4fcdae41c">GifPartitionByMedian</a> (uint8_t *image, int left, int right, int com, int neededCenter)</td></tr>
<tr class="separator:aa3789c1923f40cb85ccccca4fcdae41c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace441d978463380721538e95c029ee71"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gif_8h.html#ace441d978463380721538e95c029ee71">GifSplitPalette</a> (uint8_t *image, int numPixels, int firstElt, int lastElt, int splitElt, int splitDist, int treeNode, bool buildForDither, <a class="el" href="struct_gif_palette.html">GifPalette</a> *pal)</td></tr>
<tr class="separator:ace441d978463380721538e95c029ee71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb04d8e237daeb334a82c9d9600e42c1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gif_8h.html#abb04d8e237daeb334a82c9d9600e42c1">GifPickChangedPixels</a> (const uint8_t *lastFrame, uint8_t *frame, int numPixels)</td></tr>
<tr class="separator:abb04d8e237daeb334a82c9d9600e42c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa74cf10fec71223e47ef8a2e58f26319"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gif_8h.html#aa74cf10fec71223e47ef8a2e58f26319">GifMakePalette</a> (const uint8_t *lastFrame, const uint8_t *nextFrame, uint32_t width, uint32_t height, int bitDepth, bool buildForDither, <a class="el" href="struct_gif_palette.html">GifPalette</a> *pPal)</td></tr>
<tr class="separator:aa74cf10fec71223e47ef8a2e58f26319"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2af5ec26f052649cc9a44ae8dfee0c71"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gif_8h.html#a2af5ec26f052649cc9a44ae8dfee0c71">GifDitherImage</a> (const uint8_t *lastFrame, const uint8_t *nextFrame, uint8_t *outFrame, uint32_t width, uint32_t height, <a class="el" href="struct_gif_palette.html">GifPalette</a> *pPal)</td></tr>
<tr class="separator:a2af5ec26f052649cc9a44ae8dfee0c71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2731ed1895124d923ccc3657203824b8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gif_8h.html#a2731ed1895124d923ccc3657203824b8">GifThresholdImage</a> (const uint8_t *lastFrame, const uint8_t *nextFrame, uint8_t *outFrame, uint32_t width, uint32_t height, <a class="el" href="struct_gif_palette.html">GifPalette</a> *pPal)</td></tr>
<tr class="separator:a2731ed1895124d923ccc3657203824b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1bef4f7413c37a9b37b49293d3aef201"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gif_8h.html#a1bef4f7413c37a9b37b49293d3aef201">GifWriteBit</a> (<a class="el" href="struct_gif_bit_status.html">GifBitStatus</a> *stat, uint32_t bit)</td></tr>
<tr class="separator:a1bef4f7413c37a9b37b49293d3aef201"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56779e2201dcfb75425c2a9563360189"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gif_8h.html#a56779e2201dcfb75425c2a9563360189">GifWriteChunk</a> (FILE *f, <a class="el" href="struct_gif_bit_status.html">GifBitStatus</a> *stat)</td></tr>
<tr class="separator:a56779e2201dcfb75425c2a9563360189"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8707778c428e9de1d108e5eb79c2c008"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gif_8h.html#a8707778c428e9de1d108e5eb79c2c008">GifWriteCode</a> (FILE *f, <a class="el" href="struct_gif_bit_status.html">GifBitStatus</a> *stat, uint32_t code, uint32_t length)</td></tr>
<tr class="separator:a8707778c428e9de1d108e5eb79c2c008"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e05fd556ad17a66a43f76a501fcff53"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gif_8h.html#a0e05fd556ad17a66a43f76a501fcff53">GifWritePalette</a> (const <a class="el" href="struct_gif_palette.html">GifPalette</a> *pPal, FILE *f)</td></tr>
<tr class="separator:a0e05fd556ad17a66a43f76a501fcff53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a0a058533dd6a0cc98c6f094e24c39e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gif_8h.html#a0a0a058533dd6a0cc98c6f094e24c39e">GifWriteLzwImage</a> (FILE *f, uint8_t *image, uint32_t left, uint32_t top, uint32_t width, uint32_t height, uint32_t delay, <a class="el" href="struct_gif_palette.html">GifPalette</a> *pPal)</td></tr>
<tr class="separator:a0a0a058533dd6a0cc98c6f094e24c39e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a3654f7bc6d4b3366af7f6d9c3188f0"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gif_8h.html#a6a3654f7bc6d4b3366af7f6d9c3188f0">GifBegin</a> (<a class="el" href="struct_gif_writer.html">GifWriter</a> *writer, const char *filename, uint32_t width, uint32_t height, uint32_t delay, int32_t bitDepth=8, bool dither=false)</td></tr>
<tr class="separator:a6a3654f7bc6d4b3366af7f6d9c3188f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27b6c046506ff30d7af6335879c467ae"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gif_8h.html#a27b6c046506ff30d7af6335879c467ae">GifWriteFrame</a> (<a class="el" href="struct_gif_writer.html">GifWriter</a> *writer, const uint8_t *image, uint32_t width, uint32_t height, uint32_t delay, int bitDepth=8, bool dither=false)</td></tr>
<tr class="separator:a27b6c046506ff30d7af6335879c467ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a1f73b78ff2797c80a4727932b9d040"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gif_8h.html#a5a1f73b78ff2797c80a4727932b9d040">GifEnd</a> (<a class="el" href="struct_gif_writer.html">GifWriter</a> *writer)</td></tr>
<tr class="separator:a5a1f73b78ff2797c80a4727932b9d040"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a3bbc4876f24cc742e2cbb68fa3c88fe9"><td class="memItemLeft" align="right" valign="top">const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gif_8h.html#a3bbc4876f24cc742e2cbb68fa3c88fe9">kGifTransIndex</a> = 0</td></tr>
<tr class="separator:a3bbc4876f24cc742e2cbb68fa3c88fe9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a3bc34de883cfe8bc534246ed759419f2" name="a3bc34de883cfe8bc534246ed759419f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3bc34de883cfe8bc534246ed759419f2">&#9670;&#160;</a></span>GIF_FREE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GIF_FREE&#160;&#160;&#160;free</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gif_8h_source.html#l00060">60</a> of file <a class="el" href="gif_8h_source.html">gif.h</a>.</p>

</div>
</div>
<a id="a05d55b62cb33c1317606fc83b79fbd2d" name="a05d55b62cb33c1317606fc83b79fbd2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05d55b62cb33c1317606fc83b79fbd2d">&#9670;&#160;</a></span>GIF_MALLOC</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GIF_MALLOC&#160;&#160;&#160;malloc</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gif_8h_source.html#l00055">55</a> of file <a class="el" href="gif_8h_source.html">gif.h</a>.</p>

</div>
</div>
<a id="a23e287fdaa48ccff1c3ff9500f358c23" name="a23e287fdaa48ccff1c3ff9500f358c23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23e287fdaa48ccff1c3ff9500f358c23">&#9670;&#160;</a></span>GIF_TEMP_FREE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GIF_TEMP_FREE&#160;&#160;&#160;free</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gif_8h_source.html#l00050">50</a> of file <a class="el" href="gif_8h_source.html">gif.h</a>.</p>

</div>
</div>
<a id="a94974606594583031e18618c12dfd1eb" name="a94974606594583031e18618c12dfd1eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94974606594583031e18618c12dfd1eb">&#9670;&#160;</a></span>GIF_TEMP_MALLOC</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GIF_TEMP_MALLOC&#160;&#160;&#160;malloc</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gif_8h_source.html#l00045">45</a> of file <a class="el" href="gif_8h_source.html">gif.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a6a3654f7bc6d4b3366af7f6d9c3188f0" name="a6a3654f7bc6d4b3366af7f6d9c3188f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a3654f7bc6d4b3366af7f6d9c3188f0">&#9670;&#160;</a></span>GifBegin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool GifBegin </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_gif_writer.html">GifWriter</a> *&#160;</td>
          <td class="paramname"><em>writer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>height</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>delay</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>bitDepth</em> = <code>8</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>dither</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gif_8h_source.html#l00738">738</a> of file <a class="el" href="gif_8h_source.html">gif.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  739</span>{</div>
<div class="line"><span class="lineno">  740</span>    (void)bitDepth; (void)dither; <span class="comment">// Mute &quot;Unused argument&quot; warnings</span></div>
<div class="line"><span class="lineno">  741</span><span class="preprocessor">#if defined(_MSC_VER) &amp;&amp; (_MSC_VER &gt;= 1400)</span></div>
<div class="line"><span class="lineno">  742</span>    writer-&gt;<a class="code hl_variable" href="struct_gif_writer.html#a241c49c94cac4fa2c84f6f04ece482a2">f</a> = 0;</div>
<div class="line"><span class="lineno">  743</span>    fopen_s(&amp;writer-&gt;<a class="code hl_variable" href="struct_gif_writer.html#a241c49c94cac4fa2c84f6f04ece482a2">f</a>, filename, <span class="stringliteral">&quot;wb&quot;</span>);</div>
<div class="line"><span class="lineno">  744</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  745</span>    writer-&gt;<a class="code hl_variable" href="struct_gif_writer.html#a241c49c94cac4fa2c84f6f04ece482a2">f</a> = fopen(filename, <span class="stringliteral">&quot;wb&quot;</span>);</div>
<div class="line"><span class="lineno">  746</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  747</span>    <span class="keywordflow">if</span>(!writer-&gt;<a class="code hl_variable" href="struct_gif_writer.html#a241c49c94cac4fa2c84f6f04ece482a2">f</a>) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  748</span> </div>
<div class="line"><span class="lineno">  749</span>    writer-&gt;<a class="code hl_variable" href="struct_gif_writer.html#aa821030c1f12ceeed53b5f3a74315a43">firstFrame</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  750</span> </div>
<div class="line"><span class="lineno">  751</span>    <span class="comment">// allocate</span></div>
<div class="line"><span class="lineno">  752</span>    writer-&gt;<a class="code hl_variable" href="struct_gif_writer.html#a26d40f7afd54139c37e099911b506812">oldImage</a> = (uint8_t*)<a class="code hl_define" href="gif_8h.html#a05d55b62cb33c1317606fc83b79fbd2d">GIF_MALLOC</a>(width*height*4);</div>
<div class="line"><span class="lineno">  753</span> </div>
<div class="line"><span class="lineno">  754</span>    fputs(<span class="stringliteral">&quot;GIF89a&quot;</span>, writer-&gt;<a class="code hl_variable" href="struct_gif_writer.html#a241c49c94cac4fa2c84f6f04ece482a2">f</a>);</div>
<div class="line"><span class="lineno">  755</span> </div>
<div class="line"><span class="lineno">  756</span>    <span class="comment">// screen descriptor</span></div>
<div class="line"><span class="lineno">  757</span>    fputc(width &amp; 0xff, writer-&gt;<a class="code hl_variable" href="struct_gif_writer.html#a241c49c94cac4fa2c84f6f04ece482a2">f</a>);</div>
<div class="line"><span class="lineno">  758</span>    fputc((width &gt;&gt; 8) &amp; 0xff, writer-&gt;<a class="code hl_variable" href="struct_gif_writer.html#a241c49c94cac4fa2c84f6f04ece482a2">f</a>);</div>
<div class="line"><span class="lineno">  759</span>    fputc(height &amp; 0xff, writer-&gt;<a class="code hl_variable" href="struct_gif_writer.html#a241c49c94cac4fa2c84f6f04ece482a2">f</a>);</div>
<div class="line"><span class="lineno">  760</span>    fputc((height &gt;&gt; 8) &amp; 0xff, writer-&gt;<a class="code hl_variable" href="struct_gif_writer.html#a241c49c94cac4fa2c84f6f04ece482a2">f</a>);</div>
<div class="line"><span class="lineno">  761</span> </div>
<div class="line"><span class="lineno">  762</span>    fputc(0xf0, writer-&gt;<a class="code hl_variable" href="struct_gif_writer.html#a241c49c94cac4fa2c84f6f04ece482a2">f</a>);  <span class="comment">// there is an unsorted global color table of 2 entries</span></div>
<div class="line"><span class="lineno">  763</span>    fputc(0, writer-&gt;<a class="code hl_variable" href="struct_gif_writer.html#a241c49c94cac4fa2c84f6f04ece482a2">f</a>);     <span class="comment">// background color</span></div>
<div class="line"><span class="lineno">  764</span>    fputc(0, writer-&gt;<a class="code hl_variable" href="struct_gif_writer.html#a241c49c94cac4fa2c84f6f04ece482a2">f</a>);     <span class="comment">// pixels are square (we need to specify this because it&#39;s 1989)</span></div>
<div class="line"><span class="lineno">  765</span> </div>
<div class="line"><span class="lineno">  766</span>    <span class="comment">// now the &quot;global&quot; palette (really just a dummy palette)</span></div>
<div class="line"><span class="lineno">  767</span>    <span class="comment">// color 0: black</span></div>
<div class="line"><span class="lineno">  768</span>    fputc(0, writer-&gt;<a class="code hl_variable" href="struct_gif_writer.html#a241c49c94cac4fa2c84f6f04ece482a2">f</a>);</div>
<div class="line"><span class="lineno">  769</span>    fputc(0, writer-&gt;<a class="code hl_variable" href="struct_gif_writer.html#a241c49c94cac4fa2c84f6f04ece482a2">f</a>);</div>
<div class="line"><span class="lineno">  770</span>    fputc(0, writer-&gt;<a class="code hl_variable" href="struct_gif_writer.html#a241c49c94cac4fa2c84f6f04ece482a2">f</a>);</div>
<div class="line"><span class="lineno">  771</span>    <span class="comment">// color 1: also black</span></div>
<div class="line"><span class="lineno">  772</span>    fputc(0, writer-&gt;<a class="code hl_variable" href="struct_gif_writer.html#a241c49c94cac4fa2c84f6f04ece482a2">f</a>);</div>
<div class="line"><span class="lineno">  773</span>    fputc(0, writer-&gt;<a class="code hl_variable" href="struct_gif_writer.html#a241c49c94cac4fa2c84f6f04ece482a2">f</a>);</div>
<div class="line"><span class="lineno">  774</span>    fputc(0, writer-&gt;<a class="code hl_variable" href="struct_gif_writer.html#a241c49c94cac4fa2c84f6f04ece482a2">f</a>);</div>
<div class="line"><span class="lineno">  775</span> </div>
<div class="line"><span class="lineno">  776</span>    <span class="keywordflow">if</span>( delay != 0 )</div>
<div class="line"><span class="lineno">  777</span>    {</div>
<div class="line"><span class="lineno">  778</span>        <span class="comment">// animation header</span></div>
<div class="line"><span class="lineno">  779</span>        fputc(0x21, writer-&gt;<a class="code hl_variable" href="struct_gif_writer.html#a241c49c94cac4fa2c84f6f04ece482a2">f</a>); <span class="comment">// extension</span></div>
<div class="line"><span class="lineno">  780</span>        fputc(0xff, writer-&gt;<a class="code hl_variable" href="struct_gif_writer.html#a241c49c94cac4fa2c84f6f04ece482a2">f</a>); <span class="comment">// application specific</span></div>
<div class="line"><span class="lineno">  781</span>        fputc(11, writer-&gt;<a class="code hl_variable" href="struct_gif_writer.html#a241c49c94cac4fa2c84f6f04ece482a2">f</a>); <span class="comment">// length 11</span></div>
<div class="line"><span class="lineno">  782</span>        fputs(<span class="stringliteral">&quot;NETSCAPE2.0&quot;</span>, writer-&gt;<a class="code hl_variable" href="struct_gif_writer.html#a241c49c94cac4fa2c84f6f04ece482a2">f</a>); <span class="comment">// yes, really</span></div>
<div class="line"><span class="lineno">  783</span>        fputc(3, writer-&gt;<a class="code hl_variable" href="struct_gif_writer.html#a241c49c94cac4fa2c84f6f04ece482a2">f</a>); <span class="comment">// 3 bytes of NETSCAPE2.0 data</span></div>
<div class="line"><span class="lineno">  784</span> </div>
<div class="line"><span class="lineno">  785</span>        fputc(1, writer-&gt;<a class="code hl_variable" href="struct_gif_writer.html#a241c49c94cac4fa2c84f6f04ece482a2">f</a>); <span class="comment">// JUST BECAUSE</span></div>
<div class="line"><span class="lineno">  786</span>        fputc(0, writer-&gt;<a class="code hl_variable" href="struct_gif_writer.html#a241c49c94cac4fa2c84f6f04ece482a2">f</a>); <span class="comment">// loop infinitely (byte 0)</span></div>
<div class="line"><span class="lineno">  787</span>        fputc(0, writer-&gt;<a class="code hl_variable" href="struct_gif_writer.html#a241c49c94cac4fa2c84f6f04ece482a2">f</a>); <span class="comment">// loop infinitely (byte 1)</span></div>
<div class="line"><span class="lineno">  788</span> </div>
<div class="line"><span class="lineno">  789</span>        fputc(0, writer-&gt;<a class="code hl_variable" href="struct_gif_writer.html#a241c49c94cac4fa2c84f6f04ece482a2">f</a>); <span class="comment">// block terminator</span></div>
<div class="line"><span class="lineno">  790</span>    }</div>
<div class="line"><span class="lineno">  791</span> </div>
<div class="line"><span class="lineno">  792</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  793</span>}</div>
<div class="ttc" id="agif_8h_html_a05d55b62cb33c1317606fc83b79fbd2d"><div class="ttname"><a href="gif_8h.html#a05d55b62cb33c1317606fc83b79fbd2d">GIF_MALLOC</a></div><div class="ttdeci">#define GIF_MALLOC</div><div class="ttdef"><b>Definition:</b> <a href="gif_8h_source.html#l00055">gif.h:55</a></div></div>
<div class="ttc" id="astruct_gif_writer_html_a241c49c94cac4fa2c84f6f04ece482a2"><div class="ttname"><a href="struct_gif_writer.html#a241c49c94cac4fa2c84f6f04ece482a2">GifWriter::f</a></div><div class="ttdeci">FILE * f</div><div class="ttdef"><b>Definition:</b> <a href="gif_8h_source.html#l00730">gif.h:730</a></div></div>
<div class="ttc" id="astruct_gif_writer_html_a26d40f7afd54139c37e099911b506812"><div class="ttname"><a href="struct_gif_writer.html#a26d40f7afd54139c37e099911b506812">GifWriter::oldImage</a></div><div class="ttdeci">uint8_t * oldImage</div><div class="ttdef"><b>Definition:</b> <a href="gif_8h_source.html#l00731">gif.h:731</a></div></div>
<div class="ttc" id="astruct_gif_writer_html_aa821030c1f12ceeed53b5f3a74315a43"><div class="ttname"><a href="struct_gif_writer.html#aa821030c1f12ceeed53b5f3a74315a43">GifWriter::firstFrame</a></div><div class="ttdeci">bool firstFrame</div><div class="ttdef"><b>Definition:</b> <a href="gif_8h_source.html#l00732">gif.h:732</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2af5ec26f052649cc9a44ae8dfee0c71" name="a2af5ec26f052649cc9a44ae8dfee0c71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2af5ec26f052649cc9a44ae8dfee0c71">&#9670;&#160;</a></span>GifDitherImage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GifDitherImage </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>lastFrame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>nextFrame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>outFrame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>height</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_gif_palette.html">GifPalette</a> *&#160;</td>
          <td class="paramname"><em>pPal</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gif_8h_source.html#l00383">383</a> of file <a class="el" href="gif_8h_source.html">gif.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  384</span>{</div>
<div class="line"><span class="lineno">  385</span>    <span class="keywordtype">int</span> numPixels = (int)(width * height);</div>
<div class="line"><span class="lineno">  386</span> </div>
<div class="line"><span class="lineno">  387</span>    <span class="comment">// quantPixels initially holds color*256 for all pixels</span></div>
<div class="line"><span class="lineno">  388</span>    <span class="comment">// The extra 8 bits of precision allow for sub-single-color error values</span></div>
<div class="line"><span class="lineno">  389</span>    <span class="comment">// to be propagated</span></div>
<div class="line"><span class="lineno">  390</span>    int32_t *quantPixels = (int32_t *)<a class="code hl_define" href="gif_8h.html#a94974606594583031e18618c12dfd1eb">GIF_TEMP_MALLOC</a>(<span class="keyword">sizeof</span>(int32_t) * (size_t)numPixels * 4);</div>
<div class="line"><span class="lineno">  391</span> </div>
<div class="line"><span class="lineno">  392</span>    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> ii=0; ii&lt;numPixels*4; ++ii )</div>
<div class="line"><span class="lineno">  393</span>    {</div>
<div class="line"><span class="lineno">  394</span>        uint8_t pix = nextFrame[ii];</div>
<div class="line"><span class="lineno">  395</span>        int32_t pix16 = (int32_t)(pix) * 256;</div>
<div class="line"><span class="lineno">  396</span>        quantPixels[ii] = pix16;</div>
<div class="line"><span class="lineno">  397</span>    }</div>
<div class="line"><span class="lineno">  398</span> </div>
<div class="line"><span class="lineno">  399</span>    <span class="keywordflow">for</span>( uint32_t yy=0; yy&lt;height; ++yy )</div>
<div class="line"><span class="lineno">  400</span>    {</div>
<div class="line"><span class="lineno">  401</span>        <span class="keywordflow">for</span>( uint32_t xx=0; xx&lt;width; ++xx )</div>
<div class="line"><span class="lineno">  402</span>        {</div>
<div class="line"><span class="lineno">  403</span>            int32_t* nextPix = quantPixels + 4*(yy*width+xx);</div>
<div class="line"><span class="lineno">  404</span>            <span class="keyword">const</span> uint8_t* lastPix = lastFrame? lastFrame + 4*(yy*width+xx) : NULL;</div>
<div class="line"><span class="lineno">  405</span> </div>
<div class="line"><span class="lineno">  406</span>            <span class="comment">// Compute the colors we want (rounding to nearest)</span></div>
<div class="line"><span class="lineno">  407</span>            int32_t rr = (nextPix[0] + 127) / 256;</div>
<div class="line"><span class="lineno">  408</span>            int32_t gg = (nextPix[1] + 127) / 256;</div>
<div class="line"><span class="lineno">  409</span>            int32_t bb = (nextPix[2] + 127) / 256;</div>
<div class="line"><span class="lineno">  410</span> </div>
<div class="line"><span class="lineno">  411</span>            <span class="comment">// if it happens that we want the color from last frame, then just write out</span></div>
<div class="line"><span class="lineno">  412</span>            <span class="comment">// a transparent pixel</span></div>
<div class="line"><span class="lineno">  413</span>            <span class="keywordflow">if</span>( lastFrame &amp;&amp;</div>
<div class="line"><span class="lineno">  414</span>               lastPix[0] == rr &amp;&amp;</div>
<div class="line"><span class="lineno">  415</span>               lastPix[1] == gg &amp;&amp;</div>
<div class="line"><span class="lineno">  416</span>               lastPix[2] == bb )</div>
<div class="line"><span class="lineno">  417</span>            {</div>
<div class="line"><span class="lineno">  418</span>                nextPix[0] = rr;</div>
<div class="line"><span class="lineno">  419</span>                nextPix[1] = gg;</div>
<div class="line"><span class="lineno">  420</span>                nextPix[2] = bb;</div>
<div class="line"><span class="lineno">  421</span>                nextPix[3] = <a class="code hl_variable" href="gif_8h.html#a3bbc4876f24cc742e2cbb68fa3c88fe9">kGifTransIndex</a>;</div>
<div class="line"><span class="lineno">  422</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  423</span>            }</div>
<div class="line"><span class="lineno">  424</span> </div>
<div class="line"><span class="lineno">  425</span>            int32_t bestDiff = 1000000;</div>
<div class="line"><span class="lineno">  426</span>            int32_t bestInd = <a class="code hl_variable" href="gif_8h.html#a3bbc4876f24cc742e2cbb68fa3c88fe9">kGifTransIndex</a>;</div>
<div class="line"><span class="lineno">  427</span> </div>
<div class="line"><span class="lineno">  428</span>            <span class="comment">// Search the palete</span></div>
<div class="line"><span class="lineno">  429</span>            <a class="code hl_function" href="gif_8h.html#a17526c4fd7bdc86c779c6253279abee5">GifGetClosestPaletteColor</a>(pPal, rr, gg, bb, &amp;bestInd, &amp;bestDiff, 1);</div>
<div class="line"><span class="lineno">  430</span> </div>
<div class="line"><span class="lineno">  431</span>            <span class="comment">// Write the result to the temp buffer</span></div>
<div class="line"><span class="lineno">  432</span>            int32_t r_err = nextPix[0] - (int32_t)(pPal-&gt;<a class="code hl_variable" href="struct_gif_palette.html#a614dead8bc7d3d8f4f24205f85a8b91b">r</a>[bestInd]) * 256;</div>
<div class="line"><span class="lineno">  433</span>            int32_t g_err = nextPix[1] - (int32_t)(pPal-&gt;<a class="code hl_variable" href="struct_gif_palette.html#a7c6b513664877530d38f31a32899bec6">g</a>[bestInd]) * 256;</div>
<div class="line"><span class="lineno">  434</span>            int32_t b_err = nextPix[2] - (int32_t)(pPal-&gt;<a class="code hl_variable" href="struct_gif_palette.html#a30c74a5ef1182b42a0fc290bd05eff51">b</a>[bestInd]) * 256;</div>
<div class="line"><span class="lineno">  435</span> </div>
<div class="line"><span class="lineno">  436</span>            nextPix[0] = pPal-&gt;<a class="code hl_variable" href="struct_gif_palette.html#a614dead8bc7d3d8f4f24205f85a8b91b">r</a>[bestInd];</div>
<div class="line"><span class="lineno">  437</span>            nextPix[1] = pPal-&gt;<a class="code hl_variable" href="struct_gif_palette.html#a7c6b513664877530d38f31a32899bec6">g</a>[bestInd];</div>
<div class="line"><span class="lineno">  438</span>            nextPix[2] = pPal-&gt;<a class="code hl_variable" href="struct_gif_palette.html#a30c74a5ef1182b42a0fc290bd05eff51">b</a>[bestInd];</div>
<div class="line"><span class="lineno">  439</span>            nextPix[3] = bestInd;</div>
<div class="line"><span class="lineno">  440</span> </div>
<div class="line"><span class="lineno">  441</span>            <span class="comment">// Propagate the error to the four adjacent locations</span></div>
<div class="line"><span class="lineno">  442</span>            <span class="comment">// that we haven&#39;t touched yet</span></div>
<div class="line"><span class="lineno">  443</span>            <span class="keywordtype">int</span> quantloc_7 = (int)(yy * width + xx + 1);</div>
<div class="line"><span class="lineno">  444</span>            <span class="keywordtype">int</span> quantloc_3 = (int)(yy * width + width + xx - 1);</div>
<div class="line"><span class="lineno">  445</span>            <span class="keywordtype">int</span> quantloc_5 = (int)(yy * width + width + xx);</div>
<div class="line"><span class="lineno">  446</span>            <span class="keywordtype">int</span> quantloc_1 = (int)(yy * width + width + xx + 1);</div>
<div class="line"><span class="lineno">  447</span> </div>
<div class="line"><span class="lineno">  448</span>            <span class="keywordflow">if</span>(quantloc_7 &lt; numPixels)</div>
<div class="line"><span class="lineno">  449</span>            {</div>
<div class="line"><span class="lineno">  450</span>                int32_t* pix7 = quantPixels+4*quantloc_7;</div>
<div class="line"><span class="lineno">  451</span>                pix7[0] += <a class="code hl_function" href="gif_8h.html#abec89660e26d5d306a68352215b9a0be">GifIMax</a>( -pix7[0], r_err * 7 / 16 );</div>
<div class="line"><span class="lineno">  452</span>                pix7[1] += <a class="code hl_function" href="gif_8h.html#abec89660e26d5d306a68352215b9a0be">GifIMax</a>( -pix7[1], g_err * 7 / 16 );</div>
<div class="line"><span class="lineno">  453</span>                pix7[2] += <a class="code hl_function" href="gif_8h.html#abec89660e26d5d306a68352215b9a0be">GifIMax</a>( -pix7[2], b_err * 7 / 16 );</div>
<div class="line"><span class="lineno">  454</span>            }</div>
<div class="line"><span class="lineno">  455</span> </div>
<div class="line"><span class="lineno">  456</span>            <span class="keywordflow">if</span>(quantloc_3 &lt; numPixels)</div>
<div class="line"><span class="lineno">  457</span>            {</div>
<div class="line"><span class="lineno">  458</span>                int32_t* pix3 = quantPixels+4*quantloc_3;</div>
<div class="line"><span class="lineno">  459</span>                pix3[0] += <a class="code hl_function" href="gif_8h.html#abec89660e26d5d306a68352215b9a0be">GifIMax</a>( -pix3[0], r_err * 3 / 16 );</div>
<div class="line"><span class="lineno">  460</span>                pix3[1] += <a class="code hl_function" href="gif_8h.html#abec89660e26d5d306a68352215b9a0be">GifIMax</a>( -pix3[1], g_err * 3 / 16 );</div>
<div class="line"><span class="lineno">  461</span>                pix3[2] += <a class="code hl_function" href="gif_8h.html#abec89660e26d5d306a68352215b9a0be">GifIMax</a>( -pix3[2], b_err * 3 / 16 );</div>
<div class="line"><span class="lineno">  462</span>            }</div>
<div class="line"><span class="lineno">  463</span> </div>
<div class="line"><span class="lineno">  464</span>            <span class="keywordflow">if</span>(quantloc_5 &lt; numPixels)</div>
<div class="line"><span class="lineno">  465</span>            {</div>
<div class="line"><span class="lineno">  466</span>                int32_t* pix5 = quantPixels+4*quantloc_5;</div>
<div class="line"><span class="lineno">  467</span>                pix5[0] += <a class="code hl_function" href="gif_8h.html#abec89660e26d5d306a68352215b9a0be">GifIMax</a>( -pix5[0], r_err * 5 / 16 );</div>
<div class="line"><span class="lineno">  468</span>                pix5[1] += <a class="code hl_function" href="gif_8h.html#abec89660e26d5d306a68352215b9a0be">GifIMax</a>( -pix5[1], g_err * 5 / 16 );</div>
<div class="line"><span class="lineno">  469</span>                pix5[2] += <a class="code hl_function" href="gif_8h.html#abec89660e26d5d306a68352215b9a0be">GifIMax</a>( -pix5[2], b_err * 5 / 16 );</div>
<div class="line"><span class="lineno">  470</span>            }</div>
<div class="line"><span class="lineno">  471</span> </div>
<div class="line"><span class="lineno">  472</span>            <span class="keywordflow">if</span>(quantloc_1 &lt; numPixels)</div>
<div class="line"><span class="lineno">  473</span>            {</div>
<div class="line"><span class="lineno">  474</span>                int32_t* pix1 = quantPixels+4*quantloc_1;</div>
<div class="line"><span class="lineno">  475</span>                pix1[0] += <a class="code hl_function" href="gif_8h.html#abec89660e26d5d306a68352215b9a0be">GifIMax</a>( -pix1[0], r_err / 16 );</div>
<div class="line"><span class="lineno">  476</span>                pix1[1] += <a class="code hl_function" href="gif_8h.html#abec89660e26d5d306a68352215b9a0be">GifIMax</a>( -pix1[1], g_err / 16 );</div>
<div class="line"><span class="lineno">  477</span>                pix1[2] += <a class="code hl_function" href="gif_8h.html#abec89660e26d5d306a68352215b9a0be">GifIMax</a>( -pix1[2], b_err / 16 );</div>
<div class="line"><span class="lineno">  478</span>            }</div>
<div class="line"><span class="lineno">  479</span>        }</div>
<div class="line"><span class="lineno">  480</span>    }</div>
<div class="line"><span class="lineno">  481</span> </div>
<div class="line"><span class="lineno">  482</span>    <span class="comment">// Copy the palettized result to the output buffer</span></div>
<div class="line"><span class="lineno">  483</span>    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> ii=0; ii&lt;numPixels*4; ++ii )</div>
<div class="line"><span class="lineno">  484</span>    {</div>
<div class="line"><span class="lineno">  485</span>        outFrame[ii] = (uint8_t)quantPixels[ii];</div>
<div class="line"><span class="lineno">  486</span>    }</div>
<div class="line"><span class="lineno">  487</span> </div>
<div class="line"><span class="lineno">  488</span>    <a class="code hl_define" href="gif_8h.html#a23e287fdaa48ccff1c3ff9500f358c23">GIF_TEMP_FREE</a>(quantPixels);</div>
<div class="line"><span class="lineno">  489</span>}</div>
<div class="ttc" id="agif_8h_html_a17526c4fd7bdc86c779c6253279abee5"><div class="ttname"><a href="gif_8h.html#a17526c4fd7bdc86c779c6253279abee5">GifGetClosestPaletteColor</a></div><div class="ttdeci">void GifGetClosestPaletteColor(GifPalette *pPal, int r, int g, int b, int *bestInd, int *bestDiff, int treeRoot)</div><div class="ttdef"><b>Definition:</b> <a href="gif_8h_source.html#l00089">gif.h:89</a></div></div>
<div class="ttc" id="agif_8h_html_a23e287fdaa48ccff1c3ff9500f358c23"><div class="ttname"><a href="gif_8h.html#a23e287fdaa48ccff1c3ff9500f358c23">GIF_TEMP_FREE</a></div><div class="ttdeci">#define GIF_TEMP_FREE</div><div class="ttdef"><b>Definition:</b> <a href="gif_8h_source.html#l00050">gif.h:50</a></div></div>
<div class="ttc" id="agif_8h_html_a3bbc4876f24cc742e2cbb68fa3c88fe9"><div class="ttname"><a href="gif_8h.html#a3bbc4876f24cc742e2cbb68fa3c88fe9">kGifTransIndex</a></div><div class="ttdeci">const int kGifTransIndex</div><div class="ttdef"><b>Definition:</b> <a href="gif_8h_source.html#l00063">gif.h:63</a></div></div>
<div class="ttc" id="agif_8h_html_a94974606594583031e18618c12dfd1eb"><div class="ttname"><a href="gif_8h.html#a94974606594583031e18618c12dfd1eb">GIF_TEMP_MALLOC</a></div><div class="ttdeci">#define GIF_TEMP_MALLOC</div><div class="ttdef"><b>Definition:</b> <a href="gif_8h_source.html#l00045">gif.h:45</a></div></div>
<div class="ttc" id="agif_8h_html_abec89660e26d5d306a68352215b9a0be"><div class="ttname"><a href="gif_8h.html#abec89660e26d5d306a68352215b9a0be">GifIMax</a></div><div class="ttdeci">int GifIMax(int l, int r)</div><div class="ttdef"><b>Definition:</b> <a href="gif_8h_source.html#l00081">gif.h:81</a></div></div>
<div class="ttc" id="astruct_gif_palette_html_a30c74a5ef1182b42a0fc290bd05eff51"><div class="ttname"><a href="struct_gif_palette.html#a30c74a5ef1182b42a0fc290bd05eff51">GifPalette::b</a></div><div class="ttdeci">uint8_t b[256]</div><div class="ttdef"><b>Definition:</b> <a href="gif_8h_source.html#l00071">gif.h:71</a></div></div>
<div class="ttc" id="astruct_gif_palette_html_a614dead8bc7d3d8f4f24205f85a8b91b"><div class="ttname"><a href="struct_gif_palette.html#a614dead8bc7d3d8f4f24205f85a8b91b">GifPalette::r</a></div><div class="ttdeci">uint8_t r[256]</div><div class="ttdef"><b>Definition:</b> <a href="gif_8h_source.html#l00069">gif.h:69</a></div></div>
<div class="ttc" id="astruct_gif_palette_html_a7c6b513664877530d38f31a32899bec6"><div class="ttname"><a href="struct_gif_palette.html#a7c6b513664877530d38f31a32899bec6">GifPalette::g</a></div><div class="ttdeci">uint8_t g[256]</div><div class="ttdef"><b>Definition:</b> <a href="gif_8h_source.html#l00070">gif.h:70</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5a1f73b78ff2797c80a4727932b9d040" name="a5a1f73b78ff2797c80a4727932b9d040"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a1f73b78ff2797c80a4727932b9d040">&#9670;&#160;</a></span>GifEnd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool GifEnd </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_gif_writer.html">GifWriter</a> *&#160;</td>
          <td class="paramname"><em>writer</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gif_8h_source.html#l00822">822</a> of file <a class="el" href="gif_8h_source.html">gif.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  823</span>{</div>
<div class="line"><span class="lineno">  824</span>    <span class="keywordflow">if</span>(!writer-&gt;<a class="code hl_variable" href="struct_gif_writer.html#a241c49c94cac4fa2c84f6f04ece482a2">f</a>) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  825</span> </div>
<div class="line"><span class="lineno">  826</span>    fputc(0x3b, writer-&gt;<a class="code hl_variable" href="struct_gif_writer.html#a241c49c94cac4fa2c84f6f04ece482a2">f</a>); <span class="comment">// end of file</span></div>
<div class="line"><span class="lineno">  827</span>    fclose(writer-&gt;<a class="code hl_variable" href="struct_gif_writer.html#a241c49c94cac4fa2c84f6f04ece482a2">f</a>);</div>
<div class="line"><span class="lineno">  828</span>    <a class="code hl_define" href="gif_8h.html#a3bc34de883cfe8bc534246ed759419f2">GIF_FREE</a>(writer-&gt;<a class="code hl_variable" href="struct_gif_writer.html#a26d40f7afd54139c37e099911b506812">oldImage</a>);</div>
<div class="line"><span class="lineno">  829</span> </div>
<div class="line"><span class="lineno">  830</span>    writer-&gt;<a class="code hl_variable" href="struct_gif_writer.html#a241c49c94cac4fa2c84f6f04ece482a2">f</a> = NULL;</div>
<div class="line"><span class="lineno">  831</span>    writer-&gt;<a class="code hl_variable" href="struct_gif_writer.html#a26d40f7afd54139c37e099911b506812">oldImage</a> = NULL;</div>
<div class="line"><span class="lineno">  832</span> </div>
<div class="line"><span class="lineno">  833</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  834</span>}</div>
<div class="ttc" id="agif_8h_html_a3bc34de883cfe8bc534246ed759419f2"><div class="ttname"><a href="gif_8h.html#a3bc34de883cfe8bc534246ed759419f2">GIF_FREE</a></div><div class="ttdeci">#define GIF_FREE</div><div class="ttdef"><b>Definition:</b> <a href="gif_8h_source.html#l00060">gif.h:60</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a17526c4fd7bdc86c779c6253279abee5" name="a17526c4fd7bdc86c779c6253279abee5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17526c4fd7bdc86c779c6253279abee5">&#9670;&#160;</a></span>GifGetClosestPaletteColor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GifGetClosestPaletteColor </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_gif_palette.html">GifPalette</a> *&#160;</td>
          <td class="paramname"><em>pPal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>bestInd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>bestDiff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>treeRoot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gif_8h_source.html#l00089">89</a> of file <a class="el" href="gif_8h_source.html">gif.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   90</span>{</div>
<div class="line"><span class="lineno">   91</span>    <span class="comment">// base case, reached the bottom of the tree</span></div>
<div class="line"><span class="lineno">   92</span>    <span class="keywordflow">if</span>(treeRoot &gt; (1&lt;&lt;pPal-&gt;<a class="code hl_variable" href="struct_gif_palette.html#a731b991a07d514c890cd3d6c9a8e51f3">bitDepth</a>)-1)</div>
<div class="line"><span class="lineno">   93</span>    {</div>
<div class="line"><span class="lineno">   94</span>        <span class="keywordtype">int</span> ind = treeRoot-(1&lt;&lt;pPal-&gt;<a class="code hl_variable" href="struct_gif_palette.html#a731b991a07d514c890cd3d6c9a8e51f3">bitDepth</a>);</div>
<div class="line"><span class="lineno">   95</span>        <span class="keywordflow">if</span>(ind == <a class="code hl_variable" href="gif_8h.html#a3bbc4876f24cc742e2cbb68fa3c88fe9">kGifTransIndex</a>) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">   96</span> </div>
<div class="line"><span class="lineno">   97</span>        <span class="comment">// check whether this color is better than the current winner</span></div>
<div class="line"><span class="lineno">   98</span>        <span class="keywordtype">int</span> r_err = r - ((int32_t)pPal-&gt;<a class="code hl_variable" href="struct_gif_palette.html#a614dead8bc7d3d8f4f24205f85a8b91b">r</a>[ind]);</div>
<div class="line"><span class="lineno">   99</span>        <span class="keywordtype">int</span> g_err = g - ((int32_t)pPal-&gt;<a class="code hl_variable" href="struct_gif_palette.html#a7c6b513664877530d38f31a32899bec6">g</a>[ind]);</div>
<div class="line"><span class="lineno">  100</span>        <span class="keywordtype">int</span> b_err = b - ((int32_t)pPal-&gt;<a class="code hl_variable" href="struct_gif_palette.html#a30c74a5ef1182b42a0fc290bd05eff51">b</a>[ind]);</div>
<div class="line"><span class="lineno">  101</span>        <span class="keywordtype">int</span> diff = <a class="code hl_function" href="gif_8h.html#a3f47fdcc507db606e3817489e15389bf">GifIAbs</a>(r_err)+<a class="code hl_function" href="gif_8h.html#a3f47fdcc507db606e3817489e15389bf">GifIAbs</a>(g_err)+<a class="code hl_function" href="gif_8h.html#a3f47fdcc507db606e3817489e15389bf">GifIAbs</a>(b_err);</div>
<div class="line"><span class="lineno">  102</span> </div>
<div class="line"><span class="lineno">  103</span>        <span class="keywordflow">if</span>(diff &lt; *bestDiff)</div>
<div class="line"><span class="lineno">  104</span>        {</div>
<div class="line"><span class="lineno">  105</span>            *bestInd = ind;</div>
<div class="line"><span class="lineno">  106</span>            *bestDiff = diff;</div>
<div class="line"><span class="lineno">  107</span>        }</div>
<div class="line"><span class="lineno">  108</span> </div>
<div class="line"><span class="lineno">  109</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  110</span>    }</div>
<div class="line"><span class="lineno">  111</span> </div>
<div class="line"><span class="lineno">  112</span>    <span class="comment">// take the appropriate color (r, g, or b) for this node of the k-d tree</span></div>
<div class="line"><span class="lineno">  113</span>    <span class="keywordtype">int</span> comps[3]; comps[0] = r; comps[1] = g; comps[2] = b;</div>
<div class="line"><span class="lineno">  114</span>    <span class="keywordtype">int</span> splitComp = comps[pPal-&gt;<a class="code hl_variable" href="struct_gif_palette.html#a333c9b8872127221ca62d41413f20638">treeSplitElt</a>[treeRoot]];</div>
<div class="line"><span class="lineno">  115</span> </div>
<div class="line"><span class="lineno">  116</span>    <span class="keywordtype">int</span> splitPos = pPal-&gt;<a class="code hl_variable" href="struct_gif_palette.html#abb62e3544c63e7ef418ead69b2c17b61">treeSplit</a>[treeRoot];</div>
<div class="line"><span class="lineno">  117</span>    <span class="keywordflow">if</span>(splitPos &gt; splitComp)</div>
<div class="line"><span class="lineno">  118</span>    {</div>
<div class="line"><span class="lineno">  119</span>        <span class="comment">// check the left subtree</span></div>
<div class="line"><span class="lineno">  120</span>        <a class="code hl_function" href="gif_8h.html#a17526c4fd7bdc86c779c6253279abee5">GifGetClosestPaletteColor</a>(pPal, r, g, b, bestInd, bestDiff, treeRoot*2);</div>
<div class="line"><span class="lineno">  121</span>        <span class="keywordflow">if</span>( *bestDiff &gt; splitPos - splitComp )</div>
<div class="line"><span class="lineno">  122</span>        {</div>
<div class="line"><span class="lineno">  123</span>            <span class="comment">// cannot prove there&#39;s not a better value in the right subtree, check that too</span></div>
<div class="line"><span class="lineno">  124</span>            <a class="code hl_function" href="gif_8h.html#a17526c4fd7bdc86c779c6253279abee5">GifGetClosestPaletteColor</a>(pPal, r, g, b, bestInd, bestDiff, treeRoot*2+1);</div>
<div class="line"><span class="lineno">  125</span>        }</div>
<div class="line"><span class="lineno">  126</span>    }</div>
<div class="line"><span class="lineno">  127</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  128</span>    {</div>
<div class="line"><span class="lineno">  129</span>        <a class="code hl_function" href="gif_8h.html#a17526c4fd7bdc86c779c6253279abee5">GifGetClosestPaletteColor</a>(pPal, r, g, b, bestInd, bestDiff, treeRoot*2+1);</div>
<div class="line"><span class="lineno">  130</span>        <span class="keywordflow">if</span>( *bestDiff &gt; splitComp - splitPos )</div>
<div class="line"><span class="lineno">  131</span>        {</div>
<div class="line"><span class="lineno">  132</span>            <a class="code hl_function" href="gif_8h.html#a17526c4fd7bdc86c779c6253279abee5">GifGetClosestPaletteColor</a>(pPal, r, g, b, bestInd, bestDiff, treeRoot*2);</div>
<div class="line"><span class="lineno">  133</span>        }</div>
<div class="line"><span class="lineno">  134</span>    }</div>
<div class="line"><span class="lineno">  135</span>}</div>
<div class="ttc" id="agif_8h_html_a3f47fdcc507db606e3817489e15389bf"><div class="ttname"><a href="gif_8h.html#a3f47fdcc507db606e3817489e15389bf">GifIAbs</a></div><div class="ttdeci">int GifIAbs(int i)</div><div class="ttdef"><b>Definition:</b> <a href="gif_8h_source.html#l00083">gif.h:83</a></div></div>
<div class="ttc" id="astruct_gif_palette_html_a333c9b8872127221ca62d41413f20638"><div class="ttname"><a href="struct_gif_palette.html#a333c9b8872127221ca62d41413f20638">GifPalette::treeSplitElt</a></div><div class="ttdeci">uint8_t treeSplitElt[256]</div><div class="ttdef"><b>Definition:</b> <a href="gif_8h_source.html#l00076">gif.h:76</a></div></div>
<div class="ttc" id="astruct_gif_palette_html_a731b991a07d514c890cd3d6c9a8e51f3"><div class="ttname"><a href="struct_gif_palette.html#a731b991a07d514c890cd3d6c9a8e51f3">GifPalette::bitDepth</a></div><div class="ttdeci">int bitDepth</div><div class="ttdef"><b>Definition:</b> <a href="gif_8h_source.html#l00067">gif.h:67</a></div></div>
<div class="ttc" id="astruct_gif_palette_html_abb62e3544c63e7ef418ead69b2c17b61"><div class="ttname"><a href="struct_gif_palette.html#abb62e3544c63e7ef418ead69b2c17b61">GifPalette::treeSplit</a></div><div class="ttdeci">uint8_t treeSplit[256]</div><div class="ttdef"><b>Definition:</b> <a href="gif_8h_source.html#l00077">gif.h:77</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3f47fdcc507db606e3817489e15389bf" name="a3f47fdcc507db606e3817489e15389bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f47fdcc507db606e3817489e15389bf">&#9670;&#160;</a></span>GifIAbs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int GifIAbs </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gif_8h_source.html#l00083">83</a> of file <a class="el" href="gif_8h_source.html">gif.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   83</span>{ <span class="keywordflow">return</span> i&lt;0?-i:i; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="abec89660e26d5d306a68352215b9a0be" name="abec89660e26d5d306a68352215b9a0be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abec89660e26d5d306a68352215b9a0be">&#9670;&#160;</a></span>GifIMax()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int GifIMax </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>r</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gif_8h_source.html#l00081">81</a> of file <a class="el" href="gif_8h_source.html">gif.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   81</span>{ <span class="keywordflow">return</span> l&gt;r?l:r; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab9dd9d911741bf4964afc6365ee09314" name="ab9dd9d911741bf4964afc6365ee09314"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9dd9d911741bf4964afc6365ee09314">&#9670;&#160;</a></span>GifIMin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int GifIMin </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>r</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gif_8h_source.html#l00082">82</a> of file <a class="el" href="gif_8h_source.html">gif.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   82</span>{ <span class="keywordflow">return</span> l&lt;r?l:r; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa74cf10fec71223e47ef8a2e58f26319" name="aa74cf10fec71223e47ef8a2e58f26319"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa74cf10fec71223e47ef8a2e58f26319">&#9670;&#160;</a></span>GifMakePalette()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GifMakePalette </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>lastFrame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>nextFrame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>height</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bitDepth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>buildForDither</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_gif_palette.html">GifPalette</a> *&#160;</td>
          <td class="paramname"><em>pPal</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gif_8h_source.html#l00353">353</a> of file <a class="el" href="gif_8h_source.html">gif.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  354</span>{</div>
<div class="line"><span class="lineno">  355</span>    pPal-&gt;<a class="code hl_variable" href="struct_gif_palette.html#a731b991a07d514c890cd3d6c9a8e51f3">bitDepth</a> = bitDepth;</div>
<div class="line"><span class="lineno">  356</span> </div>
<div class="line"><span class="lineno">  357</span>    <span class="comment">// SplitPalette is destructive (it sorts the pixels by color) so</span></div>
<div class="line"><span class="lineno">  358</span>    <span class="comment">// we must create a copy of the image for it to destroy</span></div>
<div class="line"><span class="lineno">  359</span>    <span class="keywordtype">size_t</span> imageSize = (size_t)(width * height * 4 * <span class="keyword">sizeof</span>(uint8_t));</div>
<div class="line"><span class="lineno">  360</span>    uint8_t* destroyableImage = (uint8_t*)<a class="code hl_define" href="gif_8h.html#a94974606594583031e18618c12dfd1eb">GIF_TEMP_MALLOC</a>(imageSize);</div>
<div class="line"><span class="lineno">  361</span>    memcpy(destroyableImage, nextFrame, imageSize);</div>
<div class="line"><span class="lineno">  362</span> </div>
<div class="line"><span class="lineno">  363</span>    <span class="keywordtype">int</span> numPixels = (int)(width * height);</div>
<div class="line"><span class="lineno">  364</span>    <span class="keywordflow">if</span>(lastFrame)</div>
<div class="line"><span class="lineno">  365</span>        numPixels = <a class="code hl_function" href="gif_8h.html#abb04d8e237daeb334a82c9d9600e42c1">GifPickChangedPixels</a>(lastFrame, destroyableImage, numPixels);</div>
<div class="line"><span class="lineno">  366</span> </div>
<div class="line"><span class="lineno">  367</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> lastElt = 1 &lt;&lt; bitDepth;</div>
<div class="line"><span class="lineno">  368</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> splitElt = lastElt/2;</div>
<div class="line"><span class="lineno">  369</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> splitDist = splitElt/2;</div>
<div class="line"><span class="lineno">  370</span> </div>
<div class="line"><span class="lineno">  371</span>    <a class="code hl_function" href="gif_8h.html#ace441d978463380721538e95c029ee71">GifSplitPalette</a>(destroyableImage, numPixels, 1, lastElt, splitElt, splitDist, 1, buildForDither, pPal);</div>
<div class="line"><span class="lineno">  372</span> </div>
<div class="line"><span class="lineno">  373</span>    <a class="code hl_define" href="gif_8h.html#a23e287fdaa48ccff1c3ff9500f358c23">GIF_TEMP_FREE</a>(destroyableImage);</div>
<div class="line"><span class="lineno">  374</span> </div>
<div class="line"><span class="lineno">  375</span>    <span class="comment">// add the bottom node for the transparency index</span></div>
<div class="line"><span class="lineno">  376</span>    pPal-&gt;<a class="code hl_variable" href="struct_gif_palette.html#abb62e3544c63e7ef418ead69b2c17b61">treeSplit</a>[1 &lt;&lt; (bitDepth-1)] = 0;</div>
<div class="line"><span class="lineno">  377</span>    pPal-&gt;<a class="code hl_variable" href="struct_gif_palette.html#a333c9b8872127221ca62d41413f20638">treeSplitElt</a>[1 &lt;&lt; (bitDepth-1)] = 0;</div>
<div class="line"><span class="lineno">  378</span> </div>
<div class="line"><span class="lineno">  379</span>    pPal-&gt;<a class="code hl_variable" href="struct_gif_palette.html#a614dead8bc7d3d8f4f24205f85a8b91b">r</a>[0] = pPal-&gt;<a class="code hl_variable" href="struct_gif_palette.html#a7c6b513664877530d38f31a32899bec6">g</a>[0] = pPal-&gt;<a class="code hl_variable" href="struct_gif_palette.html#a30c74a5ef1182b42a0fc290bd05eff51">b</a>[0] = 0;</div>
<div class="line"><span class="lineno">  380</span>}</div>
<div class="ttc" id="agif_8h_html_abb04d8e237daeb334a82c9d9600e42c1"><div class="ttname"><a href="gif_8h.html#abb04d8e237daeb334a82c9d9600e42c1">GifPickChangedPixels</a></div><div class="ttdeci">int GifPickChangedPixels(const uint8_t *lastFrame, uint8_t *frame, int numPixels)</div><div class="ttdef"><b>Definition:</b> <a href="gif_8h_source.html#l00327">gif.h:327</a></div></div>
<div class="ttc" id="agif_8h_html_ace441d978463380721538e95c029ee71"><div class="ttname"><a href="gif_8h.html#ace441d978463380721538e95c029ee71">GifSplitPalette</a></div><div class="ttdeci">void GifSplitPalette(uint8_t *image, int numPixels, int firstElt, int lastElt, int splitElt, int splitDist, int treeNode, bool buildForDither, GifPalette *pal)</div><div class="ttdef"><b>Definition:</b> <a href="gif_8h_source.html#l00208">gif.h:208</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5d40946fe75133f3be72b4e4d096b776" name="a5d40946fe75133f3be72b4e4d096b776"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d40946fe75133f3be72b4e4d096b776">&#9670;&#160;</a></span>GifPartition()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int GifPartition </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>left</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>right</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>elt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pivotIndex</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gif_8h_source.html#l00161">161</a> of file <a class="el" href="gif_8h_source.html">gif.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  162</span>{</div>
<div class="line"><span class="lineno">  163</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> pivotValue = image[(pivotIndex)*4+elt];</div>
<div class="line"><span class="lineno">  164</span>    <a class="code hl_function" href="gif_8h.html#a6df6365a4dbdd83db88521f7159af7f7">GifSwapPixels</a>(image, pivotIndex, right-1);</div>
<div class="line"><span class="lineno">  165</span>    <span class="keywordtype">int</span> storeIndex = left;</div>
<div class="line"><span class="lineno">  166</span>    <span class="keywordtype">bool</span> split = 0;</div>
<div class="line"><span class="lineno">  167</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ii=left; ii&lt;right-1; ++ii)</div>
<div class="line"><span class="lineno">  168</span>    {</div>
<div class="line"><span class="lineno">  169</span>        <span class="keywordtype">int</span> arrayVal = image[ii*4+elt];</div>
<div class="line"><span class="lineno">  170</span>        <span class="keywordflow">if</span>( arrayVal &lt; pivotValue )</div>
<div class="line"><span class="lineno">  171</span>        {</div>
<div class="line"><span class="lineno">  172</span>            <a class="code hl_function" href="gif_8h.html#a6df6365a4dbdd83db88521f7159af7f7">GifSwapPixels</a>(image, ii, storeIndex);</div>
<div class="line"><span class="lineno">  173</span>            ++storeIndex;</div>
<div class="line"><span class="lineno">  174</span>        }</div>
<div class="line"><span class="lineno">  175</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( arrayVal == pivotValue )</div>
<div class="line"><span class="lineno">  176</span>        {</div>
<div class="line"><span class="lineno">  177</span>            <span class="keywordflow">if</span>(split)</div>
<div class="line"><span class="lineno">  178</span>            {</div>
<div class="line"><span class="lineno">  179</span>                <a class="code hl_function" href="gif_8h.html#a6df6365a4dbdd83db88521f7159af7f7">GifSwapPixels</a>(image, ii, storeIndex);</div>
<div class="line"><span class="lineno">  180</span>                ++storeIndex;</div>
<div class="line"><span class="lineno">  181</span>            }</div>
<div class="line"><span class="lineno">  182</span>            split = !split;</div>
<div class="line"><span class="lineno">  183</span>        }</div>
<div class="line"><span class="lineno">  184</span>    }</div>
<div class="line"><span class="lineno">  185</span>    <a class="code hl_function" href="gif_8h.html#a6df6365a4dbdd83db88521f7159af7f7">GifSwapPixels</a>(image, storeIndex, right-1);</div>
<div class="line"><span class="lineno">  186</span>    <span class="keywordflow">return</span> storeIndex;</div>
<div class="line"><span class="lineno">  187</span>}</div>
<div class="ttc" id="agif_8h_html_a6df6365a4dbdd83db88521f7159af7f7"><div class="ttname"><a href="gif_8h.html#a6df6365a4dbdd83db88521f7159af7f7">GifSwapPixels</a></div><div class="ttdeci">void GifSwapPixels(uint8_t *image, int pixA, int pixB)</div><div class="ttdef"><b>Definition:</b> <a href="gif_8h_source.html#l00137">gif.h:137</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa3789c1923f40cb85ccccca4fcdae41c" name="aa3789c1923f40cb85ccccca4fcdae41c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3789c1923f40cb85ccccca4fcdae41c">&#9670;&#160;</a></span>GifPartitionByMedian()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GifPartitionByMedian </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>left</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>right</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>com</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>neededCenter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gif_8h_source.html#l00190">190</a> of file <a class="el" href="gif_8h_source.html">gif.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  191</span>{</div>
<div class="line"><span class="lineno">  192</span>    <span class="keywordflow">if</span>(left &lt; right-1)</div>
<div class="line"><span class="lineno">  193</span>    {</div>
<div class="line"><span class="lineno">  194</span>        <span class="keywordtype">int</span> pivotIndex = left + (right-left)/2;</div>
<div class="line"><span class="lineno">  195</span> </div>
<div class="line"><span class="lineno">  196</span>        pivotIndex = <a class="code hl_function" href="gif_8h.html#a5d40946fe75133f3be72b4e4d096b776">GifPartition</a>(image, left, right, com, pivotIndex);</div>
<div class="line"><span class="lineno">  197</span> </div>
<div class="line"><span class="lineno">  198</span>        <span class="comment">// Only &quot;sort&quot; the section of the array that contains the median</span></div>
<div class="line"><span class="lineno">  199</span>        <span class="keywordflow">if</span>(pivotIndex &gt; neededCenter)</div>
<div class="line"><span class="lineno">  200</span>            <a class="code hl_function" href="gif_8h.html#aa3789c1923f40cb85ccccca4fcdae41c">GifPartitionByMedian</a>(image, left, pivotIndex, com, neededCenter);</div>
<div class="line"><span class="lineno">  201</span> </div>
<div class="line"><span class="lineno">  202</span>        <span class="keywordflow">if</span>(pivotIndex &lt; neededCenter)</div>
<div class="line"><span class="lineno">  203</span>            <a class="code hl_function" href="gif_8h.html#aa3789c1923f40cb85ccccca4fcdae41c">GifPartitionByMedian</a>(image, pivotIndex+1, right, com, neededCenter);</div>
<div class="line"><span class="lineno">  204</span>    }</div>
<div class="line"><span class="lineno">  205</span>}</div>
<div class="ttc" id="agif_8h_html_a5d40946fe75133f3be72b4e4d096b776"><div class="ttname"><a href="gif_8h.html#a5d40946fe75133f3be72b4e4d096b776">GifPartition</a></div><div class="ttdeci">int GifPartition(uint8_t *image, const int left, const int right, const int elt, int pivotIndex)</div><div class="ttdef"><b>Definition:</b> <a href="gif_8h_source.html#l00161">gif.h:161</a></div></div>
<div class="ttc" id="agif_8h_html_aa3789c1923f40cb85ccccca4fcdae41c"><div class="ttname"><a href="gif_8h.html#aa3789c1923f40cb85ccccca4fcdae41c">GifPartitionByMedian</a></div><div class="ttdeci">void GifPartitionByMedian(uint8_t *image, int left, int right, int com, int neededCenter)</div><div class="ttdef"><b>Definition:</b> <a href="gif_8h_source.html#l00190">gif.h:190</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abb04d8e237daeb334a82c9d9600e42c1" name="abb04d8e237daeb334a82c9d9600e42c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb04d8e237daeb334a82c9d9600e42c1">&#9670;&#160;</a></span>GifPickChangedPixels()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int GifPickChangedPixels </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>lastFrame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>frame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numPixels</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gif_8h_source.html#l00327">327</a> of file <a class="el" href="gif_8h_source.html">gif.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  328</span>{</div>
<div class="line"><span class="lineno">  329</span>    <span class="keywordtype">int</span> numChanged = 0;</div>
<div class="line"><span class="lineno">  330</span>    uint8_t* writeIter = frame;</div>
<div class="line"><span class="lineno">  331</span> </div>
<div class="line"><span class="lineno">  332</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii=0; ii&lt;numPixels; ++ii)</div>
<div class="line"><span class="lineno">  333</span>    {</div>
<div class="line"><span class="lineno">  334</span>        <span class="keywordflow">if</span>(lastFrame[0] != frame[0] ||</div>
<div class="line"><span class="lineno">  335</span>           lastFrame[1] != frame[1] ||</div>
<div class="line"><span class="lineno">  336</span>           lastFrame[2] != frame[2])</div>
<div class="line"><span class="lineno">  337</span>        {</div>
<div class="line"><span class="lineno">  338</span>            writeIter[0] = frame[0];</div>
<div class="line"><span class="lineno">  339</span>            writeIter[1] = frame[1];</div>
<div class="line"><span class="lineno">  340</span>            writeIter[2] = frame[2];</div>
<div class="line"><span class="lineno">  341</span>            ++numChanged;</div>
<div class="line"><span class="lineno">  342</span>            writeIter += 4;</div>
<div class="line"><span class="lineno">  343</span>        }</div>
<div class="line"><span class="lineno">  344</span>        lastFrame += 4;</div>
<div class="line"><span class="lineno">  345</span>        frame += 4;</div>
<div class="line"><span class="lineno">  346</span>    }</div>
<div class="line"><span class="lineno">  347</span> </div>
<div class="line"><span class="lineno">  348</span>    <span class="keywordflow">return</span> numChanged;</div>
<div class="line"><span class="lineno">  349</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ace441d978463380721538e95c029ee71" name="ace441d978463380721538e95c029ee71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace441d978463380721538e95c029ee71">&#9670;&#160;</a></span>GifSplitPalette()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GifSplitPalette </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numPixels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>firstElt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lastElt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>splitElt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>splitDist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>treeNode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>buildForDither</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_gif_palette.html">GifPalette</a> *&#160;</td>
          <td class="paramname"><em>pal</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gif_8h_source.html#l00208">208</a> of file <a class="el" href="gif_8h_source.html">gif.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  209</span>{</div>
<div class="line"><span class="lineno">  210</span>    <span class="keywordflow">if</span>(lastElt &lt;= firstElt || numPixels == 0)</div>
<div class="line"><span class="lineno">  211</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  212</span> </div>
<div class="line"><span class="lineno">  213</span>    <span class="comment">// base case, bottom of the tree</span></div>
<div class="line"><span class="lineno">  214</span>    <span class="keywordflow">if</span>(lastElt == firstElt+1)</div>
<div class="line"><span class="lineno">  215</span>    {</div>
<div class="line"><span class="lineno">  216</span>        <span class="keywordflow">if</span>(buildForDither)</div>
<div class="line"><span class="lineno">  217</span>        {</div>
<div class="line"><span class="lineno">  218</span>            <span class="comment">// Dithering needs at least one color as dark as anything</span></div>
<div class="line"><span class="lineno">  219</span>            <span class="comment">// in the image and at least one brightest color -</span></div>
<div class="line"><span class="lineno">  220</span>            <span class="comment">// otherwise it builds up error and produces strange artifacts</span></div>
<div class="line"><span class="lineno">  221</span>            <span class="keywordflow">if</span>( firstElt == 1 )</div>
<div class="line"><span class="lineno">  222</span>            {</div>
<div class="line"><span class="lineno">  223</span>                <span class="comment">// special case: the darkest color in the image</span></div>
<div class="line"><span class="lineno">  224</span>                uint32_t r=255, g=255, b=255;</div>
<div class="line"><span class="lineno">  225</span>                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ii=0; ii&lt;numPixels; ++ii)</div>
<div class="line"><span class="lineno">  226</span>                {</div>
<div class="line"><span class="lineno">  227</span>                    r = (uint32_t)<a class="code hl_function" href="gif_8h.html#ab9dd9d911741bf4964afc6365ee09314">GifIMin</a>((int32_t)r, image[ii * 4 + 0]);</div>
<div class="line"><span class="lineno">  228</span>                    g = (uint32_t)<a class="code hl_function" href="gif_8h.html#ab9dd9d911741bf4964afc6365ee09314">GifIMin</a>((int32_t)g, image[ii * 4 + 1]);</div>
<div class="line"><span class="lineno">  229</span>                    b = (uint32_t)<a class="code hl_function" href="gif_8h.html#ab9dd9d911741bf4964afc6365ee09314">GifIMin</a>((int32_t)b, image[ii * 4 + 2]);</div>
<div class="line"><span class="lineno">  230</span>                }</div>
<div class="line"><span class="lineno">  231</span> </div>
<div class="line"><span class="lineno">  232</span>                pal-&gt;<a class="code hl_variable" href="struct_gif_palette.html#a614dead8bc7d3d8f4f24205f85a8b91b">r</a>[firstElt] = (uint8_t)r;</div>
<div class="line"><span class="lineno">  233</span>                pal-&gt;<a class="code hl_variable" href="struct_gif_palette.html#a7c6b513664877530d38f31a32899bec6">g</a>[firstElt] = (uint8_t)g;</div>
<div class="line"><span class="lineno">  234</span>                pal-&gt;<a class="code hl_variable" href="struct_gif_palette.html#a30c74a5ef1182b42a0fc290bd05eff51">b</a>[firstElt] = (uint8_t)b;</div>
<div class="line"><span class="lineno">  235</span> </div>
<div class="line"><span class="lineno">  236</span>                <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  237</span>            }</div>
<div class="line"><span class="lineno">  238</span> </div>
<div class="line"><span class="lineno">  239</span>            <span class="keywordflow">if</span>( firstElt == (1 &lt;&lt; pal-&gt;<a class="code hl_variable" href="struct_gif_palette.html#a731b991a07d514c890cd3d6c9a8e51f3">bitDepth</a>)-1 )</div>
<div class="line"><span class="lineno">  240</span>            {</div>
<div class="line"><span class="lineno">  241</span>                <span class="comment">// special case: the lightest color in the image</span></div>
<div class="line"><span class="lineno">  242</span>                uint32_t r=0, g=0, b=0;</div>
<div class="line"><span class="lineno">  243</span>                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ii=0; ii&lt;numPixels; ++ii)</div>
<div class="line"><span class="lineno">  244</span>                {</div>
<div class="line"><span class="lineno">  245</span>                    r = (uint32_t)<a class="code hl_function" href="gif_8h.html#abec89660e26d5d306a68352215b9a0be">GifIMax</a>((int32_t)r, image[ii * 4 + 0]);</div>
<div class="line"><span class="lineno">  246</span>                    g = (uint32_t)<a class="code hl_function" href="gif_8h.html#abec89660e26d5d306a68352215b9a0be">GifIMax</a>((int32_t)g, image[ii * 4 + 1]);</div>
<div class="line"><span class="lineno">  247</span>                    b = (uint32_t)<a class="code hl_function" href="gif_8h.html#abec89660e26d5d306a68352215b9a0be">GifIMax</a>((int32_t)b, image[ii * 4 + 2]);</div>
<div class="line"><span class="lineno">  248</span>                }</div>
<div class="line"><span class="lineno">  249</span> </div>
<div class="line"><span class="lineno">  250</span>                pal-&gt;<a class="code hl_variable" href="struct_gif_palette.html#a614dead8bc7d3d8f4f24205f85a8b91b">r</a>[firstElt] = (uint8_t)r;</div>
<div class="line"><span class="lineno">  251</span>                pal-&gt;<a class="code hl_variable" href="struct_gif_palette.html#a7c6b513664877530d38f31a32899bec6">g</a>[firstElt] = (uint8_t)g;</div>
<div class="line"><span class="lineno">  252</span>                pal-&gt;<a class="code hl_variable" href="struct_gif_palette.html#a30c74a5ef1182b42a0fc290bd05eff51">b</a>[firstElt] = (uint8_t)b;</div>
<div class="line"><span class="lineno">  253</span> </div>
<div class="line"><span class="lineno">  254</span>                <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  255</span>            }</div>
<div class="line"><span class="lineno">  256</span>        }</div>
<div class="line"><span class="lineno">  257</span> </div>
<div class="line"><span class="lineno">  258</span>        <span class="comment">// otherwise, take the average of all colors in this subcube</span></div>
<div class="line"><span class="lineno">  259</span>        uint64_t r=0, g=0, b=0;</div>
<div class="line"><span class="lineno">  260</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ii=0; ii&lt;numPixels; ++ii)</div>
<div class="line"><span class="lineno">  261</span>        {</div>
<div class="line"><span class="lineno">  262</span>            r += image[ii*4+0];</div>
<div class="line"><span class="lineno">  263</span>            g += image[ii*4+1];</div>
<div class="line"><span class="lineno">  264</span>            b += image[ii*4+2];</div>
<div class="line"><span class="lineno">  265</span>        }</div>
<div class="line"><span class="lineno">  266</span> </div>
<div class="line"><span class="lineno">  267</span>        r += (uint64_t)numPixels / 2;  <span class="comment">// round to nearest</span></div>
<div class="line"><span class="lineno">  268</span>        g += (uint64_t)numPixels / 2;</div>
<div class="line"><span class="lineno">  269</span>        b += (uint64_t)numPixels / 2;</div>
<div class="line"><span class="lineno">  270</span> </div>
<div class="line"><span class="lineno">  271</span>        r /= (uint64_t)numPixels;</div>
<div class="line"><span class="lineno">  272</span>        g /= (uint64_t)numPixels;</div>
<div class="line"><span class="lineno">  273</span>        b /= (uint64_t)numPixels;</div>
<div class="line"><span class="lineno">  274</span> </div>
<div class="line"><span class="lineno">  275</span>        pal-&gt;<a class="code hl_variable" href="struct_gif_palette.html#a614dead8bc7d3d8f4f24205f85a8b91b">r</a>[firstElt] = (uint8_t)r;</div>
<div class="line"><span class="lineno">  276</span>        pal-&gt;<a class="code hl_variable" href="struct_gif_palette.html#a7c6b513664877530d38f31a32899bec6">g</a>[firstElt] = (uint8_t)g;</div>
<div class="line"><span class="lineno">  277</span>        pal-&gt;<a class="code hl_variable" href="struct_gif_palette.html#a30c74a5ef1182b42a0fc290bd05eff51">b</a>[firstElt] = (uint8_t)b;</div>
<div class="line"><span class="lineno">  278</span> </div>
<div class="line"><span class="lineno">  279</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  280</span>    }</div>
<div class="line"><span class="lineno">  281</span> </div>
<div class="line"><span class="lineno">  282</span>    <span class="comment">// Find the axis with the largest range</span></div>
<div class="line"><span class="lineno">  283</span>    <span class="keywordtype">int</span> minR = 255, maxR = 0;</div>
<div class="line"><span class="lineno">  284</span>    <span class="keywordtype">int</span> minG = 255, maxG = 0;</div>
<div class="line"><span class="lineno">  285</span>    <span class="keywordtype">int</span> minB = 255, maxB = 0;</div>
<div class="line"><span class="lineno">  286</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ii=0; ii&lt;numPixels; ++ii)</div>
<div class="line"><span class="lineno">  287</span>    {</div>
<div class="line"><span class="lineno">  288</span>        <span class="keywordtype">int</span> r = image[ii*4+0];</div>
<div class="line"><span class="lineno">  289</span>        <span class="keywordtype">int</span> g = image[ii*4+1];</div>
<div class="line"><span class="lineno">  290</span>        <span class="keywordtype">int</span> b = image[ii*4+2];</div>
<div class="line"><span class="lineno">  291</span> </div>
<div class="line"><span class="lineno">  292</span>        <span class="keywordflow">if</span>(r &gt; maxR) maxR = r;</div>
<div class="line"><span class="lineno">  293</span>        <span class="keywordflow">if</span>(r &lt; minR) minR = r;</div>
<div class="line"><span class="lineno">  294</span> </div>
<div class="line"><span class="lineno">  295</span>        <span class="keywordflow">if</span>(g &gt; maxG) maxG = g;</div>
<div class="line"><span class="lineno">  296</span>        <span class="keywordflow">if</span>(g &lt; minG) minG = g;</div>
<div class="line"><span class="lineno">  297</span> </div>
<div class="line"><span class="lineno">  298</span>        <span class="keywordflow">if</span>(b &gt; maxB) maxB = b;</div>
<div class="line"><span class="lineno">  299</span>        <span class="keywordflow">if</span>(b &lt; minB) minB = b;</div>
<div class="line"><span class="lineno">  300</span>    }</div>
<div class="line"><span class="lineno">  301</span> </div>
<div class="line"><span class="lineno">  302</span>    <span class="keywordtype">int</span> rRange = maxR - minR;</div>
<div class="line"><span class="lineno">  303</span>    <span class="keywordtype">int</span> gRange = maxG - minG;</div>
<div class="line"><span class="lineno">  304</span>    <span class="keywordtype">int</span> bRange = maxB - minB;</div>
<div class="line"><span class="lineno">  305</span> </div>
<div class="line"><span class="lineno">  306</span>    <span class="comment">// and split along that axis. (incidentally, this means this isn&#39;t a &quot;proper&quot; k-d tree but I don&#39;t know what else to call it)</span></div>
<div class="line"><span class="lineno">  307</span>    <span class="keywordtype">int</span> splitCom = 1;</div>
<div class="line"><span class="lineno">  308</span>    <span class="keywordflow">if</span>(bRange &gt; gRange) splitCom = 2;</div>
<div class="line"><span class="lineno">  309</span>    <span class="keywordflow">if</span>(rRange &gt; bRange &amp;&amp; rRange &gt; gRange) splitCom = 0;</div>
<div class="line"><span class="lineno">  310</span> </div>
<div class="line"><span class="lineno">  311</span>    <span class="keywordtype">int</span> subPixelsA = numPixels * (splitElt - firstElt) / (lastElt - firstElt);</div>
<div class="line"><span class="lineno">  312</span>    <span class="keywordtype">int</span> subPixelsB = numPixels-subPixelsA;</div>
<div class="line"><span class="lineno">  313</span> </div>
<div class="line"><span class="lineno">  314</span>    <a class="code hl_function" href="gif_8h.html#aa3789c1923f40cb85ccccca4fcdae41c">GifPartitionByMedian</a>(image, 0, numPixels, splitCom, subPixelsA);</div>
<div class="line"><span class="lineno">  315</span> </div>
<div class="line"><span class="lineno">  316</span>    pal-&gt;<a class="code hl_variable" href="struct_gif_palette.html#a333c9b8872127221ca62d41413f20638">treeSplitElt</a>[treeNode] = (uint8_t)splitCom;</div>
<div class="line"><span class="lineno">  317</span>    pal-&gt;<a class="code hl_variable" href="struct_gif_palette.html#abb62e3544c63e7ef418ead69b2c17b61">treeSplit</a>[treeNode] = image[subPixelsA*4+splitCom];</div>
<div class="line"><span class="lineno">  318</span> </div>
<div class="line"><span class="lineno">  319</span>    <a class="code hl_function" href="gif_8h.html#ace441d978463380721538e95c029ee71">GifSplitPalette</a>(image,              subPixelsA, firstElt, splitElt, splitElt-splitDist, splitDist/2, treeNode*2,   buildForDither, pal);</div>
<div class="line"><span class="lineno">  320</span>    <a class="code hl_function" href="gif_8h.html#ace441d978463380721538e95c029ee71">GifSplitPalette</a>(image+subPixelsA*4, subPixelsB, splitElt, lastElt,  splitElt+splitDist, splitDist/2, treeNode*2+1, buildForDither, pal);</div>
<div class="line"><span class="lineno">  321</span>}</div>
<div class="ttc" id="agif_8h_html_ab9dd9d911741bf4964afc6365ee09314"><div class="ttname"><a href="gif_8h.html#ab9dd9d911741bf4964afc6365ee09314">GifIMin</a></div><div class="ttdeci">int GifIMin(int l, int r)</div><div class="ttdef"><b>Definition:</b> <a href="gif_8h_source.html#l00082">gif.h:82</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6df6365a4dbdd83db88521f7159af7f7" name="a6df6365a4dbdd83db88521f7159af7f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6df6365a4dbdd83db88521f7159af7f7">&#9670;&#160;</a></span>GifSwapPixels()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GifSwapPixels </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pixA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pixB</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gif_8h_source.html#l00137">137</a> of file <a class="el" href="gif_8h_source.html">gif.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  138</span>{</div>
<div class="line"><span class="lineno">  139</span>    uint8_t rA = image[pixA*4];</div>
<div class="line"><span class="lineno">  140</span>    uint8_t gA = image[pixA*4+1];</div>
<div class="line"><span class="lineno">  141</span>    uint8_t bA = image[pixA*4+2];</div>
<div class="line"><span class="lineno">  142</span>    uint8_t aA = image[pixA*4+3];</div>
<div class="line"><span class="lineno">  143</span> </div>
<div class="line"><span class="lineno">  144</span>    uint8_t rB = image[pixB*4];</div>
<div class="line"><span class="lineno">  145</span>    uint8_t gB = image[pixB*4+1];</div>
<div class="line"><span class="lineno">  146</span>    uint8_t bB = image[pixB*4+2];</div>
<div class="line"><span class="lineno">  147</span>    uint8_t aB = image[pixA*4+3];</div>
<div class="line"><span class="lineno">  148</span> </div>
<div class="line"><span class="lineno">  149</span>    image[pixA*4] = rB;</div>
<div class="line"><span class="lineno">  150</span>    image[pixA*4+1] = gB;</div>
<div class="line"><span class="lineno">  151</span>    image[pixA*4+2] = bB;</div>
<div class="line"><span class="lineno">  152</span>    image[pixA*4+3] = aB;</div>
<div class="line"><span class="lineno">  153</span> </div>
<div class="line"><span class="lineno">  154</span>    image[pixB*4] = rA;</div>
<div class="line"><span class="lineno">  155</span>    image[pixB*4+1] = gA;</div>
<div class="line"><span class="lineno">  156</span>    image[pixB*4+2] = bA;</div>
<div class="line"><span class="lineno">  157</span>    image[pixB*4+3] = aA;</div>
<div class="line"><span class="lineno">  158</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2731ed1895124d923ccc3657203824b8" name="a2731ed1895124d923ccc3657203824b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2731ed1895124d923ccc3657203824b8">&#9670;&#160;</a></span>GifThresholdImage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GifThresholdImage </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>lastFrame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>nextFrame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>outFrame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>height</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_gif_palette.html">GifPalette</a> *&#160;</td>
          <td class="paramname"><em>pPal</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gif_8h_source.html#l00492">492</a> of file <a class="el" href="gif_8h_source.html">gif.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  493</span>{</div>
<div class="line"><span class="lineno">  494</span>    uint32_t numPixels = width*height;</div>
<div class="line"><span class="lineno">  495</span>    <span class="keywordflow">for</span>( uint32_t ii=0; ii&lt;numPixels; ++ii )</div>
<div class="line"><span class="lineno">  496</span>    {</div>
<div class="line"><span class="lineno">  497</span>        <span class="comment">// if a previous color is available, and it matches the current color,</span></div>
<div class="line"><span class="lineno">  498</span>        <span class="comment">// set the pixel to transparent</span></div>
<div class="line"><span class="lineno">  499</span>        <span class="keywordflow">if</span>(lastFrame &amp;&amp;</div>
<div class="line"><span class="lineno">  500</span>           lastFrame[0] == nextFrame[0] &amp;&amp;</div>
<div class="line"><span class="lineno">  501</span>           lastFrame[1] == nextFrame[1] &amp;&amp;</div>
<div class="line"><span class="lineno">  502</span>           lastFrame[2] == nextFrame[2])</div>
<div class="line"><span class="lineno">  503</span>        {</div>
<div class="line"><span class="lineno">  504</span>            outFrame[0] = lastFrame[0];</div>
<div class="line"><span class="lineno">  505</span>            outFrame[1] = lastFrame[1];</div>
<div class="line"><span class="lineno">  506</span>            outFrame[2] = lastFrame[2];</div>
<div class="line"><span class="lineno">  507</span>            outFrame[3] = <a class="code hl_variable" href="gif_8h.html#a3bbc4876f24cc742e2cbb68fa3c88fe9">kGifTransIndex</a>;</div>
<div class="line"><span class="lineno">  508</span>        }</div>
<div class="line"><span class="lineno">  509</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  510</span>        {</div>
<div class="line"><span class="lineno">  511</span>            <span class="comment">// palettize the pixel</span></div>
<div class="line"><span class="lineno">  512</span>            int32_t bestDiff = 1000000;</div>
<div class="line"><span class="lineno">  513</span>            int32_t bestInd = 1;</div>
<div class="line"><span class="lineno">  514</span>            <a class="code hl_function" href="gif_8h.html#a17526c4fd7bdc86c779c6253279abee5">GifGetClosestPaletteColor</a>(pPal, nextFrame[0], nextFrame[1], nextFrame[2], &amp;bestInd, &amp;bestDiff, 1);</div>
<div class="line"><span class="lineno">  515</span> </div>
<div class="line"><span class="lineno">  516</span>            <span class="comment">// Write the resulting color to the output buffer</span></div>
<div class="line"><span class="lineno">  517</span>            outFrame[0] = pPal-&gt;<a class="code hl_variable" href="struct_gif_palette.html#a614dead8bc7d3d8f4f24205f85a8b91b">r</a>[bestInd];</div>
<div class="line"><span class="lineno">  518</span>            outFrame[1] = pPal-&gt;<a class="code hl_variable" href="struct_gif_palette.html#a7c6b513664877530d38f31a32899bec6">g</a>[bestInd];</div>
<div class="line"><span class="lineno">  519</span>            outFrame[2] = pPal-&gt;<a class="code hl_variable" href="struct_gif_palette.html#a30c74a5ef1182b42a0fc290bd05eff51">b</a>[bestInd];</div>
<div class="line"><span class="lineno">  520</span>            outFrame[3] = (uint8_t)bestInd;</div>
<div class="line"><span class="lineno">  521</span>        }</div>
<div class="line"><span class="lineno">  522</span> </div>
<div class="line"><span class="lineno">  523</span>        <span class="keywordflow">if</span>(lastFrame) lastFrame += 4;</div>
<div class="line"><span class="lineno">  524</span>        outFrame += 4;</div>
<div class="line"><span class="lineno">  525</span>        nextFrame += 4;</div>
<div class="line"><span class="lineno">  526</span>    }</div>
<div class="line"><span class="lineno">  527</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1bef4f7413c37a9b37b49293d3aef201" name="a1bef4f7413c37a9b37b49293d3aef201"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1bef4f7413c37a9b37b49293d3aef201">&#9670;&#160;</a></span>GifWriteBit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GifWriteBit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_gif_bit_status.html">GifBitStatus</a> *&#160;</td>
          <td class="paramname"><em>stat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>bit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gif_8h_source.html#l00541">541</a> of file <a class="el" href="gif_8h_source.html">gif.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  542</span>{</div>
<div class="line"><span class="lineno">  543</span>    bit = bit &amp; 1;</div>
<div class="line"><span class="lineno">  544</span>    bit = bit &lt;&lt; stat-&gt;<a class="code hl_variable" href="struct_gif_bit_status.html#af9656fa0f44b70918f837c64f11c454d">bitIndex</a>;</div>
<div class="line"><span class="lineno">  545</span>    stat-&gt;<a class="code hl_variable" href="struct_gif_bit_status.html#a7987e3fd77a0c0d785daa3c04e2e51f3">byte</a> |= bit;</div>
<div class="line"><span class="lineno">  546</span> </div>
<div class="line"><span class="lineno">  547</span>    ++stat-&gt;<a class="code hl_variable" href="struct_gif_bit_status.html#af9656fa0f44b70918f837c64f11c454d">bitIndex</a>;</div>
<div class="line"><span class="lineno">  548</span>    <span class="keywordflow">if</span>( stat-&gt;<a class="code hl_variable" href="struct_gif_bit_status.html#af9656fa0f44b70918f837c64f11c454d">bitIndex</a> &gt; 7 )</div>
<div class="line"><span class="lineno">  549</span>    {</div>
<div class="line"><span class="lineno">  550</span>        <span class="comment">// move the newly-finished byte to the chunk buffer</span></div>
<div class="line"><span class="lineno">  551</span>        stat-&gt;<a class="code hl_variable" href="struct_gif_bit_status.html#a733355b73a7c87b148c42d8ae820a79c">chunk</a>[stat-&gt;<a class="code hl_variable" href="struct_gif_bit_status.html#a4018ea26e19f7e11b280564ed32c8ec0">chunkIndex</a>++] = stat-&gt;<a class="code hl_variable" href="struct_gif_bit_status.html#a7987e3fd77a0c0d785daa3c04e2e51f3">byte</a>;</div>
<div class="line"><span class="lineno">  552</span>        <span class="comment">// and start a new byte</span></div>
<div class="line"><span class="lineno">  553</span>        stat-&gt;<a class="code hl_variable" href="struct_gif_bit_status.html#af9656fa0f44b70918f837c64f11c454d">bitIndex</a> = 0;</div>
<div class="line"><span class="lineno">  554</span>        stat-&gt;<a class="code hl_variable" href="struct_gif_bit_status.html#a7987e3fd77a0c0d785daa3c04e2e51f3">byte</a> = 0;</div>
<div class="line"><span class="lineno">  555</span>    }</div>
<div class="line"><span class="lineno">  556</span>}</div>
<div class="ttc" id="astruct_gif_bit_status_html_a4018ea26e19f7e11b280564ed32c8ec0"><div class="ttname"><a href="struct_gif_bit_status.html#a4018ea26e19f7e11b280564ed32c8ec0">GifBitStatus::chunkIndex</a></div><div class="ttdeci">uint32_t chunkIndex</div><div class="ttdef"><b>Definition:</b> <a href="gif_8h_source.html#l00536">gif.h:536</a></div></div>
<div class="ttc" id="astruct_gif_bit_status_html_a733355b73a7c87b148c42d8ae820a79c"><div class="ttname"><a href="struct_gif_bit_status.html#a733355b73a7c87b148c42d8ae820a79c">GifBitStatus::chunk</a></div><div class="ttdeci">uint8_t chunk[256]</div><div class="ttdef"><b>Definition:</b> <a href="gif_8h_source.html#l00537">gif.h:537</a></div></div>
<div class="ttc" id="astruct_gif_bit_status_html_a7987e3fd77a0c0d785daa3c04e2e51f3"><div class="ttname"><a href="struct_gif_bit_status.html#a7987e3fd77a0c0d785daa3c04e2e51f3">GifBitStatus::byte</a></div><div class="ttdeci">uint8_t byte</div><div class="ttdef"><b>Definition:</b> <a href="gif_8h_source.html#l00534">gif.h:534</a></div></div>
<div class="ttc" id="astruct_gif_bit_status_html_af9656fa0f44b70918f837c64f11c454d"><div class="ttname"><a href="struct_gif_bit_status.html#af9656fa0f44b70918f837c64f11c454d">GifBitStatus::bitIndex</a></div><div class="ttdeci">uint8_t bitIndex</div><div class="ttdef"><b>Definition:</b> <a href="gif_8h_source.html#l00533">gif.h:533</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a56779e2201dcfb75425c2a9563360189" name="a56779e2201dcfb75425c2a9563360189"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56779e2201dcfb75425c2a9563360189">&#9670;&#160;</a></span>GifWriteChunk()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GifWriteChunk </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_gif_bit_status.html">GifBitStatus</a> *&#160;</td>
          <td class="paramname"><em>stat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gif_8h_source.html#l00559">559</a> of file <a class="el" href="gif_8h_source.html">gif.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  560</span>{</div>
<div class="line"><span class="lineno">  561</span>    fputc((<span class="keywordtype">int</span>)stat-&gt;<a class="code hl_variable" href="struct_gif_bit_status.html#a4018ea26e19f7e11b280564ed32c8ec0">chunkIndex</a>, f);</div>
<div class="line"><span class="lineno">  562</span>    fwrite(stat-&gt;<a class="code hl_variable" href="struct_gif_bit_status.html#a733355b73a7c87b148c42d8ae820a79c">chunk</a>, 1, stat-&gt;<a class="code hl_variable" href="struct_gif_bit_status.html#a4018ea26e19f7e11b280564ed32c8ec0">chunkIndex</a>, f);</div>
<div class="line"><span class="lineno">  563</span> </div>
<div class="line"><span class="lineno">  564</span>    stat-&gt;<a class="code hl_variable" href="struct_gif_bit_status.html#af9656fa0f44b70918f837c64f11c454d">bitIndex</a> = 0;</div>
<div class="line"><span class="lineno">  565</span>    stat-&gt;<a class="code hl_variable" href="struct_gif_bit_status.html#a7987e3fd77a0c0d785daa3c04e2e51f3">byte</a> = 0;</div>
<div class="line"><span class="lineno">  566</span>    stat-&gt;<a class="code hl_variable" href="struct_gif_bit_status.html#a4018ea26e19f7e11b280564ed32c8ec0">chunkIndex</a> = 0;</div>
<div class="line"><span class="lineno">  567</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8707778c428e9de1d108e5eb79c2c008" name="a8707778c428e9de1d108e5eb79c2c008"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8707778c428e9de1d108e5eb79c2c008">&#9670;&#160;</a></span>GifWriteCode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GifWriteCode </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_gif_bit_status.html">GifBitStatus</a> *&#160;</td>
          <td class="paramname"><em>stat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>code</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gif_8h_source.html#l00569">569</a> of file <a class="el" href="gif_8h_source.html">gif.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  570</span>{</div>
<div class="line"><span class="lineno">  571</span>    <span class="keywordflow">for</span>( uint32_t ii=0; ii&lt;length; ++ii )</div>
<div class="line"><span class="lineno">  572</span>    {</div>
<div class="line"><span class="lineno">  573</span>        <a class="code hl_function" href="gif_8h.html#a1bef4f7413c37a9b37b49293d3aef201">GifWriteBit</a>(stat, code);</div>
<div class="line"><span class="lineno">  574</span>        code = code &gt;&gt; 1;</div>
<div class="line"><span class="lineno">  575</span> </div>
<div class="line"><span class="lineno">  576</span>        <span class="keywordflow">if</span>( stat-&gt;<a class="code hl_variable" href="struct_gif_bit_status.html#a4018ea26e19f7e11b280564ed32c8ec0">chunkIndex</a> == 255 )</div>
<div class="line"><span class="lineno">  577</span>        {</div>
<div class="line"><span class="lineno">  578</span>            <a class="code hl_function" href="gif_8h.html#a56779e2201dcfb75425c2a9563360189">GifWriteChunk</a>(f, stat);</div>
<div class="line"><span class="lineno">  579</span>        }</div>
<div class="line"><span class="lineno">  580</span>    }</div>
<div class="line"><span class="lineno">  581</span>}</div>
<div class="ttc" id="agif_8h_html_a1bef4f7413c37a9b37b49293d3aef201"><div class="ttname"><a href="gif_8h.html#a1bef4f7413c37a9b37b49293d3aef201">GifWriteBit</a></div><div class="ttdeci">void GifWriteBit(GifBitStatus *stat, uint32_t bit)</div><div class="ttdef"><b>Definition:</b> <a href="gif_8h_source.html#l00541">gif.h:541</a></div></div>
<div class="ttc" id="agif_8h_html_a56779e2201dcfb75425c2a9563360189"><div class="ttname"><a href="gif_8h.html#a56779e2201dcfb75425c2a9563360189">GifWriteChunk</a></div><div class="ttdeci">void GifWriteChunk(FILE *f, GifBitStatus *stat)</div><div class="ttdef"><b>Definition:</b> <a href="gif_8h_source.html#l00559">gif.h:559</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a27b6c046506ff30d7af6335879c467ae" name="a27b6c046506ff30d7af6335879c467ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27b6c046506ff30d7af6335879c467ae">&#9670;&#160;</a></span>GifWriteFrame()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool GifWriteFrame </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_gif_writer.html">GifWriter</a> *&#160;</td>
          <td class="paramname"><em>writer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>height</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>delay</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bitDepth</em> = <code>8</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>dither</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gif_8h_source.html#l00799">799</a> of file <a class="el" href="gif_8h_source.html">gif.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  800</span>{</div>
<div class="line"><span class="lineno">  801</span>    <span class="keywordflow">if</span>(!writer-&gt;<a class="code hl_variable" href="struct_gif_writer.html#a241c49c94cac4fa2c84f6f04ece482a2">f</a>) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  802</span> </div>
<div class="line"><span class="lineno">  803</span>    <span class="keyword">const</span> uint8_t* oldImage = writer-&gt;<a class="code hl_variable" href="struct_gif_writer.html#aa821030c1f12ceeed53b5f3a74315a43">firstFrame</a>? NULL : writer-&gt;<a class="code hl_variable" href="struct_gif_writer.html#a26d40f7afd54139c37e099911b506812">oldImage</a>;</div>
<div class="line"><span class="lineno">  804</span>    writer-&gt;<a class="code hl_variable" href="struct_gif_writer.html#aa821030c1f12ceeed53b5f3a74315a43">firstFrame</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  805</span> </div>
<div class="line"><span class="lineno">  806</span>    <a class="code hl_struct" href="struct_gif_palette.html">GifPalette</a> pal;</div>
<div class="line"><span class="lineno">  807</span>    <a class="code hl_function" href="gif_8h.html#aa74cf10fec71223e47ef8a2e58f26319">GifMakePalette</a>((dither? NULL : oldImage), image, width, height, bitDepth, dither, &amp;pal);</div>
<div class="line"><span class="lineno">  808</span> </div>
<div class="line"><span class="lineno">  809</span>    <span class="keywordflow">if</span>(dither)</div>
<div class="line"><span class="lineno">  810</span>        <a class="code hl_function" href="gif_8h.html#a2af5ec26f052649cc9a44ae8dfee0c71">GifDitherImage</a>(oldImage, image, writer-&gt;<a class="code hl_variable" href="struct_gif_writer.html#a26d40f7afd54139c37e099911b506812">oldImage</a>, width, height, &amp;pal);</div>
<div class="line"><span class="lineno">  811</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  812</span>        <a class="code hl_function" href="gif_8h.html#a2731ed1895124d923ccc3657203824b8">GifThresholdImage</a>(oldImage, image, writer-&gt;<a class="code hl_variable" href="struct_gif_writer.html#a26d40f7afd54139c37e099911b506812">oldImage</a>, width, height, &amp;pal);</div>
<div class="line"><span class="lineno">  813</span> </div>
<div class="line"><span class="lineno">  814</span>    <a class="code hl_function" href="gif_8h.html#a0a0a058533dd6a0cc98c6f094e24c39e">GifWriteLzwImage</a>(writer-&gt;<a class="code hl_variable" href="struct_gif_writer.html#a241c49c94cac4fa2c84f6f04ece482a2">f</a>, writer-&gt;<a class="code hl_variable" href="struct_gif_writer.html#a26d40f7afd54139c37e099911b506812">oldImage</a>, 0, 0, width, height, delay, &amp;pal);</div>
<div class="line"><span class="lineno">  815</span> </div>
<div class="line"><span class="lineno">  816</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  817</span>}</div>
<div class="ttc" id="agif_8h_html_a0a0a058533dd6a0cc98c6f094e24c39e"><div class="ttname"><a href="gif_8h.html#a0a0a058533dd6a0cc98c6f094e24c39e">GifWriteLzwImage</a></div><div class="ttdeci">void GifWriteLzwImage(FILE *f, uint8_t *image, uint32_t left, uint32_t top, uint32_t width, uint32_t height, uint32_t delay, GifPalette *pPal)</div><div class="ttdef"><b>Definition:</b> <a href="gif_8h_source.html#l00610">gif.h:610</a></div></div>
<div class="ttc" id="agif_8h_html_a2731ed1895124d923ccc3657203824b8"><div class="ttname"><a href="gif_8h.html#a2731ed1895124d923ccc3657203824b8">GifThresholdImage</a></div><div class="ttdeci">void GifThresholdImage(const uint8_t *lastFrame, const uint8_t *nextFrame, uint8_t *outFrame, uint32_t width, uint32_t height, GifPalette *pPal)</div><div class="ttdef"><b>Definition:</b> <a href="gif_8h_source.html#l00492">gif.h:492</a></div></div>
<div class="ttc" id="agif_8h_html_a2af5ec26f052649cc9a44ae8dfee0c71"><div class="ttname"><a href="gif_8h.html#a2af5ec26f052649cc9a44ae8dfee0c71">GifDitherImage</a></div><div class="ttdeci">void GifDitherImage(const uint8_t *lastFrame, const uint8_t *nextFrame, uint8_t *outFrame, uint32_t width, uint32_t height, GifPalette *pPal)</div><div class="ttdef"><b>Definition:</b> <a href="gif_8h_source.html#l00383">gif.h:383</a></div></div>
<div class="ttc" id="agif_8h_html_aa74cf10fec71223e47ef8a2e58f26319"><div class="ttname"><a href="gif_8h.html#aa74cf10fec71223e47ef8a2e58f26319">GifMakePalette</a></div><div class="ttdeci">void GifMakePalette(const uint8_t *lastFrame, const uint8_t *nextFrame, uint32_t width, uint32_t height, int bitDepth, bool buildForDither, GifPalette *pPal)</div><div class="ttdef"><b>Definition:</b> <a href="gif_8h_source.html#l00353">gif.h:353</a></div></div>
<div class="ttc" id="astruct_gif_palette_html"><div class="ttname"><a href="struct_gif_palette.html">GifPalette</a></div><div class="ttdef"><b>Definition:</b> <a href="gif_8h_source.html#l00065">gif.h:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0a0a058533dd6a0cc98c6f094e24c39e" name="a0a0a058533dd6a0cc98c6f094e24c39e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a0a058533dd6a0cc98c6f094e24c39e">&#9670;&#160;</a></span>GifWriteLzwImage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GifWriteLzwImage </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>left</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>top</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>height</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>delay</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_gif_palette.html">GifPalette</a> *&#160;</td>
          <td class="paramname"><em>pPal</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gif_8h_source.html#l00610">610</a> of file <a class="el" href="gif_8h_source.html">gif.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  611</span>{</div>
<div class="line"><span class="lineno">  612</span>    <span class="comment">// graphics control extension</span></div>
<div class="line"><span class="lineno">  613</span>    fputc(0x21, f);</div>
<div class="line"><span class="lineno">  614</span>    fputc(0xf9, f);</div>
<div class="line"><span class="lineno">  615</span>    fputc(0x04, f);</div>
<div class="line"><span class="lineno">  616</span>    fputc(0x05, f); <span class="comment">// leave prev frame in place, this frame has transparency</span></div>
<div class="line"><span class="lineno">  617</span>    fputc(delay &amp; 0xff, f);</div>
<div class="line"><span class="lineno">  618</span>    fputc((delay &gt;&gt; 8) &amp; 0xff, f);</div>
<div class="line"><span class="lineno">  619</span>    fputc(<a class="code hl_variable" href="gif_8h.html#a3bbc4876f24cc742e2cbb68fa3c88fe9">kGifTransIndex</a>, f); <span class="comment">// transparent color index</span></div>
<div class="line"><span class="lineno">  620</span>    fputc(0, f);</div>
<div class="line"><span class="lineno">  621</span> </div>
<div class="line"><span class="lineno">  622</span>    fputc(0x2c, f); <span class="comment">// image descriptor block</span></div>
<div class="line"><span class="lineno">  623</span> </div>
<div class="line"><span class="lineno">  624</span>    fputc(left &amp; 0xff, f);           <span class="comment">// corner of image in canvas space</span></div>
<div class="line"><span class="lineno">  625</span>    fputc((left &gt;&gt; 8) &amp; 0xff, f);</div>
<div class="line"><span class="lineno">  626</span>    fputc(top &amp; 0xff, f);</div>
<div class="line"><span class="lineno">  627</span>    fputc((top &gt;&gt; 8) &amp; 0xff, f);</div>
<div class="line"><span class="lineno">  628</span> </div>
<div class="line"><span class="lineno">  629</span>    fputc(width &amp; 0xff, f);          <span class="comment">// width and height of image</span></div>
<div class="line"><span class="lineno">  630</span>    fputc((width &gt;&gt; 8) &amp; 0xff, f);</div>
<div class="line"><span class="lineno">  631</span>    fputc(height &amp; 0xff, f);</div>
<div class="line"><span class="lineno">  632</span>    fputc((height &gt;&gt; 8) &amp; 0xff, f);</div>
<div class="line"><span class="lineno">  633</span> </div>
<div class="line"><span class="lineno">  634</span>    <span class="comment">//fputc(0, f); // no local color table, no transparency</span></div>
<div class="line"><span class="lineno">  635</span>    <span class="comment">//fputc(0x80, f); // no local color table, but transparency</span></div>
<div class="line"><span class="lineno">  636</span> </div>
<div class="line"><span class="lineno">  637</span>    fputc(0x80 + pPal-&gt;<a class="code hl_variable" href="struct_gif_palette.html#a731b991a07d514c890cd3d6c9a8e51f3">bitDepth</a>-1, f); <span class="comment">// local color table present, 2 ^ bitDepth entries</span></div>
<div class="line"><span class="lineno">  638</span>    <a class="code hl_function" href="gif_8h.html#a0e05fd556ad17a66a43f76a501fcff53">GifWritePalette</a>(pPal, f);</div>
<div class="line"><span class="lineno">  639</span> </div>
<div class="line"><span class="lineno">  640</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> minCodeSize = pPal-&gt;<a class="code hl_variable" href="struct_gif_palette.html#a731b991a07d514c890cd3d6c9a8e51f3">bitDepth</a>;</div>
<div class="line"><span class="lineno">  641</span>    <span class="keyword">const</span> uint32_t clearCode = 1 &lt;&lt; pPal-&gt;<a class="code hl_variable" href="struct_gif_palette.html#a731b991a07d514c890cd3d6c9a8e51f3">bitDepth</a>;</div>
<div class="line"><span class="lineno">  642</span> </div>
<div class="line"><span class="lineno">  643</span>    fputc(minCodeSize, f); <span class="comment">// min code size 8 bits</span></div>
<div class="line"><span class="lineno">  644</span> </div>
<div class="line"><span class="lineno">  645</span>    <a class="code hl_struct" href="struct_gif_lzw_node.html">GifLzwNode</a>* codetree = (<a class="code hl_struct" href="struct_gif_lzw_node.html">GifLzwNode</a>*)<a class="code hl_define" href="gif_8h.html#a94974606594583031e18618c12dfd1eb">GIF_TEMP_MALLOC</a>(<span class="keyword">sizeof</span>(<a class="code hl_struct" href="struct_gif_lzw_node.html">GifLzwNode</a>)*4096);</div>
<div class="line"><span class="lineno">  646</span> </div>
<div class="line"><span class="lineno">  647</span>    memset(codetree, 0, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="struct_gif_lzw_node.html">GifLzwNode</a>)*4096);</div>
<div class="line"><span class="lineno">  648</span>    int32_t curCode = -1;</div>
<div class="line"><span class="lineno">  649</span>    uint32_t codeSize = (uint32_t)minCodeSize + 1;</div>
<div class="line"><span class="lineno">  650</span>    uint32_t maxCode = clearCode+1;</div>
<div class="line"><span class="lineno">  651</span> </div>
<div class="line"><span class="lineno">  652</span>    <a class="code hl_struct" href="struct_gif_bit_status.html">GifBitStatus</a> stat;</div>
<div class="line"><span class="lineno">  653</span>    stat.<a class="code hl_variable" href="struct_gif_bit_status.html#a7987e3fd77a0c0d785daa3c04e2e51f3">byte</a> = 0;</div>
<div class="line"><span class="lineno">  654</span>    stat.<a class="code hl_variable" href="struct_gif_bit_status.html#af9656fa0f44b70918f837c64f11c454d">bitIndex</a> = 0;</div>
<div class="line"><span class="lineno">  655</span>    stat.<a class="code hl_variable" href="struct_gif_bit_status.html#a4018ea26e19f7e11b280564ed32c8ec0">chunkIndex</a> = 0;</div>
<div class="line"><span class="lineno">  656</span> </div>
<div class="line"><span class="lineno">  657</span>    <a class="code hl_function" href="gif_8h.html#a8707778c428e9de1d108e5eb79c2c008">GifWriteCode</a>(f, &amp;stat, clearCode, codeSize);  <span class="comment">// start with a fresh LZW dictionary</span></div>
<div class="line"><span class="lineno">  658</span> </div>
<div class="line"><span class="lineno">  659</span>    <span class="keywordflow">for</span>(uint32_t yy=0; yy&lt;height; ++yy)</div>
<div class="line"><span class="lineno">  660</span>    {</div>
<div class="line"><span class="lineno">  661</span>        <span class="keywordflow">for</span>(uint32_t xx=0; xx&lt;width; ++xx)</div>
<div class="line"><span class="lineno">  662</span>        {</div>
<div class="line"><span class="lineno">  663</span><span class="preprocessor">    #ifdef GIF_FLIP_VERT</span></div>
<div class="line"><span class="lineno">  664</span>            <span class="comment">// bottom-left origin image (such as an OpenGL capture)</span></div>
<div class="line"><span class="lineno">  665</span>            uint8_t nextValue = image[((height-1-yy)*width+xx)*4+3];</div>
<div class="line"><span class="lineno">  666</span><span class="preprocessor">    #else</span></div>
<div class="line"><span class="lineno">  667</span>            <span class="comment">// top-left origin</span></div>
<div class="line"><span class="lineno">  668</span>            uint8_t nextValue = image[(yy*width+xx)*4+3];</div>
<div class="line"><span class="lineno">  669</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  670</span> </div>
<div class="line"><span class="lineno">  671</span>            <span class="comment">// &quot;loser mode&quot; - no compression, every single code is followed immediately by a clear</span></div>
<div class="line"><span class="lineno">  672</span>            <span class="comment">//WriteCode( f, stat, nextValue, codeSize );</span></div>
<div class="line"><span class="lineno">  673</span>            <span class="comment">//WriteCode( f, stat, 256, codeSize );</span></div>
<div class="line"><span class="lineno">  674</span> </div>
<div class="line"><span class="lineno">  675</span>            <span class="keywordflow">if</span>( curCode &lt; 0 )</div>
<div class="line"><span class="lineno">  676</span>            {</div>
<div class="line"><span class="lineno">  677</span>                <span class="comment">// first value in a new run</span></div>
<div class="line"><span class="lineno">  678</span>                curCode = nextValue;</div>
<div class="line"><span class="lineno">  679</span>            }</div>
<div class="line"><span class="lineno">  680</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span>( codetree[curCode].m_next[nextValue] )</div>
<div class="line"><span class="lineno">  681</span>            {</div>
<div class="line"><span class="lineno">  682</span>                <span class="comment">// current run already in the dictionary</span></div>
<div class="line"><span class="lineno">  683</span>                curCode = codetree[curCode].<a class="code hl_variable" href="struct_gif_lzw_node.html#aba8e227e7db39c9c65f0d31f1e0014f1">m_next</a>[nextValue];</div>
<div class="line"><span class="lineno">  684</span>            }</div>
<div class="line"><span class="lineno">  685</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  686</span>            {</div>
<div class="line"><span class="lineno">  687</span>                <span class="comment">// finish the current run, write a code</span></div>
<div class="line"><span class="lineno">  688</span>                <a class="code hl_function" href="gif_8h.html#a8707778c428e9de1d108e5eb79c2c008">GifWriteCode</a>(f, &amp;stat, (uint32_t)curCode, codeSize);</div>
<div class="line"><span class="lineno">  689</span> </div>
<div class="line"><span class="lineno">  690</span>                <span class="comment">// insert the new run into the dictionary</span></div>
<div class="line"><span class="lineno">  691</span>                codetree[curCode].<a class="code hl_variable" href="struct_gif_lzw_node.html#aba8e227e7db39c9c65f0d31f1e0014f1">m_next</a>[nextValue] = (uint16_t)++maxCode;</div>
<div class="line"><span class="lineno">  692</span> </div>
<div class="line"><span class="lineno">  693</span>                <span class="keywordflow">if</span>( maxCode &gt;= (1ul &lt;&lt; codeSize) )</div>
<div class="line"><span class="lineno">  694</span>                {</div>
<div class="line"><span class="lineno">  695</span>                    <span class="comment">// dictionary entry count has broken a size barrier,</span></div>
<div class="line"><span class="lineno">  696</span>                    <span class="comment">// we need more bits for codes</span></div>
<div class="line"><span class="lineno">  697</span>                    codeSize++;</div>
<div class="line"><span class="lineno">  698</span>                }</div>
<div class="line"><span class="lineno">  699</span>                <span class="keywordflow">if</span>( maxCode == 4095 )</div>
<div class="line"><span class="lineno">  700</span>                {</div>
<div class="line"><span class="lineno">  701</span>                    <span class="comment">// the dictionary is full, clear it out and begin anew</span></div>
<div class="line"><span class="lineno">  702</span>                    <a class="code hl_function" href="gif_8h.html#a8707778c428e9de1d108e5eb79c2c008">GifWriteCode</a>(f, &amp;stat, clearCode, codeSize); <span class="comment">// clear tree</span></div>
<div class="line"><span class="lineno">  703</span> </div>
<div class="line"><span class="lineno">  704</span>                    memset(codetree, 0, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="struct_gif_lzw_node.html">GifLzwNode</a>)*4096);</div>
<div class="line"><span class="lineno">  705</span>                    codeSize = (uint32_t)(minCodeSize + 1);</div>
<div class="line"><span class="lineno">  706</span>                    maxCode = clearCode+1;</div>
<div class="line"><span class="lineno">  707</span>                }</div>
<div class="line"><span class="lineno">  708</span> </div>
<div class="line"><span class="lineno">  709</span>                curCode = nextValue;</div>
<div class="line"><span class="lineno">  710</span>            }</div>
<div class="line"><span class="lineno">  711</span>        }</div>
<div class="line"><span class="lineno">  712</span>    }</div>
<div class="line"><span class="lineno">  713</span> </div>
<div class="line"><span class="lineno">  714</span>    <span class="comment">// compression footer</span></div>
<div class="line"><span class="lineno">  715</span>    <a class="code hl_function" href="gif_8h.html#a8707778c428e9de1d108e5eb79c2c008">GifWriteCode</a>(f, &amp;stat, (uint32_t)curCode, codeSize);</div>
<div class="line"><span class="lineno">  716</span>    <a class="code hl_function" href="gif_8h.html#a8707778c428e9de1d108e5eb79c2c008">GifWriteCode</a>(f, &amp;stat, clearCode, codeSize);</div>
<div class="line"><span class="lineno">  717</span>    <a class="code hl_function" href="gif_8h.html#a8707778c428e9de1d108e5eb79c2c008">GifWriteCode</a>(f, &amp;stat, clearCode + 1, (uint32_t)minCodeSize + 1);</div>
<div class="line"><span class="lineno">  718</span> </div>
<div class="line"><span class="lineno">  719</span>    <span class="comment">// write out the last partial chunk</span></div>
<div class="line"><span class="lineno">  720</span>    <span class="keywordflow">while</span>( stat.<a class="code hl_variable" href="struct_gif_bit_status.html#af9656fa0f44b70918f837c64f11c454d">bitIndex</a> ) <a class="code hl_function" href="gif_8h.html#a1bef4f7413c37a9b37b49293d3aef201">GifWriteBit</a>(&amp;stat, 0);</div>
<div class="line"><span class="lineno">  721</span>    <span class="keywordflow">if</span>( stat.<a class="code hl_variable" href="struct_gif_bit_status.html#a4018ea26e19f7e11b280564ed32c8ec0">chunkIndex</a> ) <a class="code hl_function" href="gif_8h.html#a56779e2201dcfb75425c2a9563360189">GifWriteChunk</a>(f, &amp;stat);</div>
<div class="line"><span class="lineno">  722</span> </div>
<div class="line"><span class="lineno">  723</span>    fputc(0, f); <span class="comment">// image block terminator</span></div>
<div class="line"><span class="lineno">  724</span> </div>
<div class="line"><span class="lineno">  725</span>    <a class="code hl_define" href="gif_8h.html#a23e287fdaa48ccff1c3ff9500f358c23">GIF_TEMP_FREE</a>(codetree);</div>
<div class="line"><span class="lineno">  726</span>}</div>
<div class="ttc" id="agif_8h_html_a0e05fd556ad17a66a43f76a501fcff53"><div class="ttname"><a href="gif_8h.html#a0e05fd556ad17a66a43f76a501fcff53">GifWritePalette</a></div><div class="ttdeci">void GifWritePalette(const GifPalette *pPal, FILE *f)</div><div class="ttdef"><b>Definition:</b> <a href="gif_8h_source.html#l00591">gif.h:591</a></div></div>
<div class="ttc" id="agif_8h_html_a8707778c428e9de1d108e5eb79c2c008"><div class="ttname"><a href="gif_8h.html#a8707778c428e9de1d108e5eb79c2c008">GifWriteCode</a></div><div class="ttdeci">void GifWriteCode(FILE *f, GifBitStatus *stat, uint32_t code, uint32_t length)</div><div class="ttdef"><b>Definition:</b> <a href="gif_8h_source.html#l00569">gif.h:569</a></div></div>
<div class="ttc" id="astruct_gif_bit_status_html"><div class="ttname"><a href="struct_gif_bit_status.html">GifBitStatus</a></div><div class="ttdef"><b>Definition:</b> <a href="gif_8h_source.html#l00531">gif.h:532</a></div></div>
<div class="ttc" id="astruct_gif_lzw_node_html"><div class="ttname"><a href="struct_gif_lzw_node.html">GifLzwNode</a></div><div class="ttdef"><b>Definition:</b> <a href="gif_8h_source.html#l00585">gif.h:586</a></div></div>
<div class="ttc" id="astruct_gif_lzw_node_html_aba8e227e7db39c9c65f0d31f1e0014f1"><div class="ttname"><a href="struct_gif_lzw_node.html#aba8e227e7db39c9c65f0d31f1e0014f1">GifLzwNode::m_next</a></div><div class="ttdeci">uint16_t m_next[256]</div><div class="ttdef"><b>Definition:</b> <a href="gif_8h_source.html#l00587">gif.h:587</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0e05fd556ad17a66a43f76a501fcff53" name="a0e05fd556ad17a66a43f76a501fcff53"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e05fd556ad17a66a43f76a501fcff53">&#9670;&#160;</a></span>GifWritePalette()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GifWritePalette </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_gif_palette.html">GifPalette</a> *&#160;</td>
          <td class="paramname"><em>pPal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>f</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gif_8h_source.html#l00591">591</a> of file <a class="el" href="gif_8h_source.html">gif.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  592</span>{</div>
<div class="line"><span class="lineno">  593</span>    fputc(0, f);  <span class="comment">// first color: transparency</span></div>
<div class="line"><span class="lineno">  594</span>    fputc(0, f);</div>
<div class="line"><span class="lineno">  595</span>    fputc(0, f);</div>
<div class="line"><span class="lineno">  596</span> </div>
<div class="line"><span class="lineno">  597</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ii=1; ii&lt;(1 &lt;&lt; pPal-&gt;<a class="code hl_variable" href="struct_gif_palette.html#a731b991a07d514c890cd3d6c9a8e51f3">bitDepth</a>); ++ii)</div>
<div class="line"><span class="lineno">  598</span>    {</div>
<div class="line"><span class="lineno">  599</span>        uint32_t r = pPal-&gt;<a class="code hl_variable" href="struct_gif_palette.html#a614dead8bc7d3d8f4f24205f85a8b91b">r</a>[ii];</div>
<div class="line"><span class="lineno">  600</span>        uint32_t g = pPal-&gt;<a class="code hl_variable" href="struct_gif_palette.html#a7c6b513664877530d38f31a32899bec6">g</a>[ii];</div>
<div class="line"><span class="lineno">  601</span>        uint32_t b = pPal-&gt;<a class="code hl_variable" href="struct_gif_palette.html#a30c74a5ef1182b42a0fc290bd05eff51">b</a>[ii];</div>
<div class="line"><span class="lineno">  602</span> </div>
<div class="line"><span class="lineno">  603</span>        fputc((<span class="keywordtype">int</span>)r, f);</div>
<div class="line"><span class="lineno">  604</span>        fputc((<span class="keywordtype">int</span>)g, f);</div>
<div class="line"><span class="lineno">  605</span>        fputc((<span class="keywordtype">int</span>)b, f);</div>
<div class="line"><span class="lineno">  606</span>    }</div>
<div class="line"><span class="lineno">  607</span>}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a3bbc4876f24cc742e2cbb68fa3c88fe9" name="a3bbc4876f24cc742e2cbb68fa3c88fe9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3bbc4876f24cc742e2cbb68fa3c88fe9">&#9670;&#160;</a></span>kGifTransIndex</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const int kGifTransIndex = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gif_8h_source.html#l00063">63</a> of file <a class="el" href="gif_8h_source.html">gif.h</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5
</small></address>
</body>
</html>
